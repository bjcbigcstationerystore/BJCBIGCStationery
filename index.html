<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>BJC Big C Stationery Store - ‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Mitr:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body{box-sizing:border-box;font-family:'Mitr',sans-serif}
    .gradient-bg{background:linear-gradient(135deg,#064e3b 0%,#065f46 50%,#047857 100%)}
    .card-shadow{box-shadow:0 20px 40px rgba(0,0,0,.15)}
    .hover-scale{transition:transform .2s ease-in-out}.hover-scale:hover{transform:scale(1.02)}
    .category-item{transition:.3s}.category-item:hover{background:#f0fdf4;border-color:#22c55e;transform:translateY(-2px)}
    .category-item.selected{background:#22c55e;color:#fff;border-color:#16a34a}
    .company-card{transition:.3s;cursor:pointer}.company-card:hover{transform:translateY(-5px);box-shadow:0 25px 50px rgba(0,0,0,.2)}
    .company-card.selected{border:4px solid #22c55e;background:#f0fdf4}
    .item-card{transition:.3s;cursor:pointer}.item-card:hover{transform:translateY(-2px);box-shadow:0 10px 25px rgba(0,0,0,.1)}
    .item-card.selected{border-color:#22c55e;background:#f0fdf4}
    .item-card.hidden-item{opacity:.5;background:#fee2e2;border-color:#ef4444}
    .quantity-input{transition:.3s}
    .logo-container{width:200px;height:120px;border-radius:16px;overflow:hidden;display:flex;align-items:center;justify-content:center;background:#fff}
    .logo-container img{max-width:180px;max-height:100px;object-fit:contain}
    .admin-company-card{transition:.3s}.admin-company-card:hover{transform:translateY(-3px);box-shadow:0 15px 30px rgba(0,0,0,.15)}
    .admin-company-card.selected{border-color:#22c55e;background:#f0fdf4}
    .admin-category-item{transition:.3s;cursor:pointer}.admin-category-item:hover{background:#f0fdf4;border-color:#22c55e;transform:translateY(-2px)}
    .admin-item-card{transition:.3s}.admin-item-card.hidden-item{background:#fee2e2;border-color:#ef4444}
    .hide-button{transition:.3s}.hide-button:hover{transform:scale(1.05)}
  </style>
</head>
<body class="gradient-bg min-h-screen">
  <!-- Admin Button -->
  <div class="fixed top-4 right-4 z-50">
    <button onclick="showAdminLogin()"
      class="bg-gray-600 hover:bg-gray-700 text-white font-medium py-2 px-4 rounded-full text-sm shadow-lg">üë§ Admin</button>
  </div>

  <!-- Admin Login Modal -->
  <div id="adminLoginModal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden">
    <div class="bg-white rounded-2xl p-8 max-w-md w-full mx-4">
      <h3 class="text-2xl font-bold text-gray-800 mb-6 text-center">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö Admin<br><span class="text-sm text-gray-500">Admin Login</span></h3>
      <div class="mb-6">
        <label class="block text-gray-700 text-sm font-bold mb-2">‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô Admin</label>
        <input type="password" id="adminPassword"
          class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-emerald-500 focus:outline-none"
          placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô Admin">
      </div>
      <div class="flex gap-4">
        <button onclick="hideAdminLogin()" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white py-3 rounded-lg">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
        <button onclick="adminLogin()" class="flex-1 bg-emerald-600 hover:bg-emerald-700 text-white py-3 rounded-lg">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
      </div>
    </div>
  </div>

  <!-- Admin Panel -->
  <div id="adminPanel" class="fixed inset-0 bg-white z-40 overflow-y-auto hidden">
    <div class="container mx-auto px-6 py-8">
      <div class="flex justify-between items-center mb-8">
        <h2 class="text-3xl font-bold text-emerald-800">‡πÅ‡∏ú‡∏á‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° Admin</h2>
        <button onclick="exitAdmin()" class="bg-red-500 hover:bg-red-600 text-white py-2 px-6 rounded-lg">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
      </div>

      <div id="adminCompanySelection" class="bg-white rounded-2xl shadow-lg p-8 mb-8">
        <h3 class="text-2xl font-bold text-gray-800 mb-6 text-center">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</h3>
        <div class="grid md:grid-cols-2 gap-8">
          <div class="admin-company-card bg-white border-4 border-gray-200 rounded-2xl p-6 cursor-pointer" onclick="selectAdminCompany('BJC')">
            <div class="logo-container mx-auto mb-4">
              <img src="https://i.postimg.cc/k4M71Cj9/BJC-logo.jpg" alt="BJC Logo" onerror="this.style.display='none'">
            </div>
            <h4 class="text-xl text-center">BJC</h4>
          </div>
          <div class="admin-company-card bg-white border-4 border-gray-200 rounded-2xl p-6 cursor-pointer" onclick="selectAdminCompany('BigC')">
            <div class="logo-container mx-auto mb-4">
              <img src="https://i.postimg.cc/50m6ypr9/logo-big.webp" alt="Big C Logo" onerror="this.style.display='none'">
            </div>
            <h4 class="text-xl text-center">Big C</h4>
          </div>
        </div>
      </div>

      <div id="adminMainView" class="bg-white rounded-2xl shadow-lg p-8 hidden">
        <div class="flex items-center justify-between mb-6">
          <h3 class="text-2xl font-bold text-gray-800">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ <span id="adminSelectedCompany" class="text-emerald-600"></span></h3>
          <button onclick="backToAdminCompanySelection()" class="bg-gray-500 hover:bg-gray-600 text-white py-2 px-6 rounded-lg">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó</button>
        </div>

        <div id="adminCategoryView" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8"></div>

        <div id="adminItemsView" class="hidden">
          <div class="flex items-center justify-between mb-8">
            <h4 id="adminCategoryTitle" class="text-2xl font-bold text-emerald-800"></h4>
            <button onclick="backToAdminCategories()" class="bg-gray-500 hover:bg-gray-600 text-white py-2 px-6 rounded-full">‚Üê ‡∏Å‡∏•‡∏±‡∏ö</button>
          </div>
          <div id="adminItemsList" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Page 1 -->
  <div id="page1" class="min-h-screen flex flex-col items-center justify-center p-6">
    <div class="bg-white rounded-3xl card-shadow p-12 max-w-5xl w-full text-center">
      <img src="https://i.postimg.cc/B6wpk3yh/cropped-Logo-BJC-Big-C-2021-2048x606.png" alt="" class="mx-auto mb-10 max-w-lg w-full h-auto" onerror="this.style.display='none'">
      <h1 class="text-5xl font-bold text-emerald-800 mb-8">BJC Big C Stationery Store<br><span class="text-3xl font-normal text-emerald-600">‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</span></h1>
      <div class="text-gray-700 text-lg leading-relaxed mb-8 max-w-4xl mx-auto space-y-4">
        <p>‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏ó‡πà‡∏≤‡∏ô‡∏Å‡∏î‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏£‡πâ‡∏≠‡∏á‚Ä¶ ‡∏à‡∏∞‡∏°‡∏µ‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πå‡πÅ‡∏à‡πâ‡∏á‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏à‡∏≤‡∏Å <b>bjcbigcstationerystore@gmail.com</b></p>
        <p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ô‡∏û‡∏î‡∏≤ ‡∏ï‡∏±‡πâ‡∏á‡∏Å‡∏ß‡∏¥‡∏•‡∏§‡∏ó‡∏±‡∏¢ Email: <b>Noppada.tan@bigc.co.th</b></p>
        <p class="text-red-600 font-bold">*‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÉ‡∏´‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ BU Admin ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡πÄ‡∏ö‡∏¥‡∏Å‡πÉ‡∏´‡πâ‡∏Å‡∏±‡∏ö BU*</p>
        <p class="text-gray-800 font-bold">‡∏™‡∏á‡∏™‡∏±‡∏¢ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ 02-1465959 #4384</p>
      </div>
      <button onclick="goToPage(2)" class="bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-5 px-12 rounded-full text-2xl hover-scale shadow-lg">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</button>
    </div>
  </div>

  <!-- Page 2 -->
  <div id="page2" class="min-h-screen flex flex-col items-center justify-center p-6 hidden">
    <div class="bg-white rounded-3xl card-shadow p-12 max-w-5xl w-full text-center">
      <h2 class="text-4xl font-bold text-emerald-800 mb-12">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏ó‡∏µ‡πà‡∏ó‡πà‡∏≤‡∏ô‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</h2>
      <div class="grid md:grid-cols-2 gap-12 mb-12">
        <div class="company-card bg-white border-4 border-gray-200 rounded-2xl p-8" onclick="selectCompany(event,'BJC')">
          <div class="logo-container mx-auto mb-6"><img src="https://i.postimg.cc/k4M71Cj9/BJC-logo.jpg" alt="" onerror="this.style.display='none'"></div>
          <h3 class="text-2xl text-gray-800">BJC</h3>
        </div>
        <div class="company-card bg-white border-4 border-gray-200 rounded-2xl p-8" onclick="selectCompany(event,'BigC')">
          <div class="logo-container mx-auto mb-6"><img src="https://i.postimg.cc/50m6ypr9/logo-big.webp" alt="" onerror="this.style.display='none'"></div>
          <h3 class="text-2xl text-gray-800">Big C</h3>
        </div>
      </div>
      <button id="nextBtn2" onclick="goToPage(3)" class="bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-4 px-10 rounded-full text-xl hover-scale opacity-50 cursor-not-allowed shadow-lg" disabled>‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
    </div>
  </div>

  <!-- Page 3 -->
  <div id="page3" class="min-h-screen flex flex-col items-center justify-center p-6 hidden">
    <div class="bg-white rounded-3xl card-shadow p-12 max-w-6xl w-full">
      <h2 class="text-4xl font-bold text-emerald-800 mb-12 text-center">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡∏¥‡πà‡∏á‡∏Ç‡∏≠‡∏á</h2>

      <!-- ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà (‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏•‡πâ‡∏ß) -->
      <div id="categoryView" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6 mb-12">
        <div class="category-item border-3 border-gray-200 rounded-xl p-6 text-center" onclick="showCategoryItems('‡πÅ‡∏ü‡πâ‡∏°‡πÅ‡∏•‡∏∞‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö')"><div class="text-4xl mb-4">üìÅ</div><span class="font-bold text-lg">‡πÅ‡∏ü‡πâ‡∏°‡πÅ‡∏•‡∏∞‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö</span><div class="text-sm text-gray-500 mt-2">0 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div></div>
        <div class="category-item border-3 border-gray-200 rounded-xl p-6 text-center" onclick="showCategoryItems('‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ï‡∏±‡∏î')"><div class="text-4xl mb-4">‚úÇÔ∏è</div><span class="font-bold text-lg">‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ï‡∏±‡∏î</span><div class="text-sm text-gray-500 mt-2">0 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div></div>
        <div class="category-item border-3 border-gray-200 rounded-xl p-6 text-center" onclick="showCategoryItems('‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏à‡∏≤‡∏∞')"><div class="text-4xl mb-4">üï≥Ô∏è</div><span class="font-bold text-lg">‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏à‡∏≤‡∏∞</span><div class="text-sm text-gray-500 mt-2">0 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div></div>
        <div class="category-item border-3 border-gray-200 rounded-xl p-6 text-center" onclick="showCategoryItems('‡∏Ñ‡∏•‡∏¥‡∏õ‡∏´‡∏ô‡∏µ‡∏ö‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©')"><div class="text-4xl mb-4">üìé</div><span class="font-bold text-lg">‡∏Ñ‡∏•‡∏¥‡∏õ‡∏´‡∏ô‡∏µ‡∏ö‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©</span><div class="text-sm text-gray-500 mt-2">0 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div></div>
        <div class="category-item border-3 border-gray-200 rounded-xl p-6 text-center" onclick="showCategoryItems('‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô')"><div class="text-4xl mb-4">‚úèÔ∏è</div><span class="font-bold text-lg">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô</span><div class="text-sm text-gray-500 mt-2">0 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div></div>
        <div class="category-item border-3 border-gray-200 rounded-xl p-6 text-center" onclick="showCategoryItems('‡∏™‡∏Å‡∏≠‡∏ï‡πÄ‡∏ó‡∏õ,‡∏Å‡∏≤‡∏ß‡πÅ‡∏•‡∏∞‡πÇ‡∏û‡∏™‡∏≠‡∏¥‡∏ó')"><div class="text-4xl mb-4">üè∑Ô∏è</div><span class="font-bold text-lg">‡∏™‡∏Å‡∏≠‡∏ï‡πÄ‡∏ó‡∏õ,‡∏Å‡∏≤‡∏ß‡πÅ‡∏•‡∏∞‡πÇ‡∏û‡∏™‡∏≠‡∏¥‡∏ó</span><div class="text-sm text-gray-500 mt-2">0 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div></div>
      </div>

      <div id="itemsView" class="hidden">
        <div class="flex items-center justify-between mb-8">
          <h3 id="categoryTitle" class="text-3xl font-bold text-emerald-800"></h3>
          <button onclick="backToCategories()" class="bg-gray-500 hover:bg-gray-600 text-white py-2 px-6 rounded-full">‚Üê ‡∏Å‡∏•‡∏±‡∏ö</button>
        </div>
        <div id="itemsList" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8"></div>
      </div>

      <div class="text-center">
        <button id="nextBtn3" onclick="goToPage(4)" class="bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-4 px-10 rounded-full text-xl hover-scale opacity-50 cursor-not-allowed shadow-lg" disabled>‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
      </div>
    </div>
  </div>

  <!-- Page 4 -->
  <div id="page4" class="min-h-screen flex flex-col items-center justify-center p-6 hidden">
    <div class="bg-white rounded-3xl card-shadow p-12 max-w-6xl w-full">
      <div class="grid lg:grid-cols-2 gap-12">
        <div class="bg-emerald-50 border-3 border-emerald-300 rounded-2xl p-8">
          <h3 class="text-2xl font-bold text-emerald-800 mb-8 text-center">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</h3>
          <div class="mb-8">
            <label class="block text-emerald-800 text-xl font-bold mb-3">‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</label>
            <input type="text" id="employeeId" class="w-full px-6 py-4 border-3 border-emerald-400 rounded-xl focus:border-emerald-600 focus:outline-none text-lg bg-white shadow-lg" placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô">
          </div>
          <div class="mb-4">
            <label class="block text-emerald-800 text-xl font-bold mb-3">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</label>
            <textarea id="remarks" rows="6" class="w-full px-6 py-4 border-3 border-emerald-400 rounded-xl focus:border-emerald-600 focus:outline-none text-lg bg-white shadow-lg" placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)"></textarea>
          </div>
        </div>

        <div class="bg-emerald-50 border-3 border-emerald-200 rounded-2xl p-8">
          <h3 class="text-2xl font-bold text-emerald-800 mb-6">‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å</h3>
          <div id="selectedItems" class="mb-6 max-h-96 overflow-y-auto"><p class="text-gray-600 text-lg">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</p></div>
          <div class="border-t-3 border-emerald-200 pt-6">
            <p class="text-2xl font-bold text-emerald-800">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ß‡∏°: <span id="totalPrice">0</span> ‡∏ö‡∏≤‡∏ó</p>
          </div>
        </div>
      </div>

      <div class="text-center mt-12">
        <button onclick="submitForm(event)" class="bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-5 px-12 rounded-full text-2xl hover-scale shadow-lg">‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏£‡πâ‡∏≠‡∏á‡∏Ç‡∏≠</button>
      </div>
    </div>
  </div>

  <!-- Success -->
  <div id="successPage" class="min-h-screen flex flex-col items-center justify-center p-6 hidden">
    <div class="bg-white rounded-3xl card-shadow p-12 max-w-3xl w-full text-center">
      <div class="text-emerald-600 text-8xl mb-8">‚úì</div>
      <h2 class="text-4xl font-bold text-emerald-800 mb-6">‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏£‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!</h2>
      <p class="text-gray-700 text-xl mb-12 leading-relaxed">‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß</p>
      <button onclick="resetForm()" class="bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-4 px-10 rounded-full text-xl hover-scale shadow-lg">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà</button>
    </div>
  </div>

  <script>
    /* ======= CONFIG ======= */
    const GAS_WEB_APP_URL = 'https://script.google.com/macros/s/PUT_YOUR_DEPLOYMENT_ID/exec'; // <-- ‡πÉ‡∏™‡πà‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì

    /* ======= STATE ======= */
    let selectedCompany = '';
    let selectedItems = {};
    let currentCategory = '';
    let itemsData = {};
    let hiddenItems = new Set();
    let isAdminMode = false, adminSelectedCompany = '', adminCurrentCategory = '';

    const ADMIN_CODES = ['BJC_ADMIN_2024','BIGC_MANAGER_001','STATIONERY_SUPER_ADMIN'];

    /* ======= ADMIN ======= */
    function showAdminLogin(){ adminLoginModal.classList.remove('hidden') }
    function hideAdminLogin(){ adminLoginModal.classList.add('hidden'); adminPassword.value='' }
    function adminLogin(){
      const pw = adminPassword.value;
      if(ADMIN_CODES.includes(pw)){ isAdminMode=true; hideAdminLogin(); showAdminPanel(); }
      else{ alert('‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô Admin ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á'); adminPassword.value=''; }
    }
    function showAdminPanel(){ adminPanel.classList.remove('hidden'); adminCompanySelection.classList.remove('hidden'); adminMainView.classList.add('hidden') }
    function exitAdmin(){ isAdminMode=false; adminSelectedCompany=''; adminCurrentCategory=''; adminPanel.classList.add('hidden'); adminCompanySelection.classList.remove('hidden'); adminMainView.classList.add('hidden') }
    function selectAdminCompany(company){
      adminSelectedCompany=company; document.getElementById('adminSelectedCompany').textContent=company;
      adminCompanySelection.classList.add('hidden'); adminMainView.classList.remove('hidden');
      if(!Object.keys(itemsData).length) loadAdminProductData(); else loadAdminCategoryView();
    }
    function backToAdminCompanySelection(){ adminCompanySelection.classList.remove('hidden'); adminMainView.classList.add('hidden'); adminCategoryView.classList.remove('hidden'); adminItemsView.classList.add('hidden'); adminSelectedCompany=''; adminCurrentCategory='' }

    async function loadAdminProductData(){
      try{
        const sheetName = adminSelectedCompany==='BigC' ? 'Prod BigC' : 'Prod BJC';
        const r = await fetch(`${GAS_WEB_APP_URL}?action=getProducts&company=${encodeURIComponent(adminSelectedCompany)}&sheet=${encodeURIComponent(sheetName)}`);
        const data = await r.json();
        if(data.success){ itemsData = data.products; loadAdminCategoryView(); }
        else { loadFallbackData(); loadAdminCategoryView(); }
      }catch(_){ loadFallbackData(); loadAdminCategoryView(); }
    }
    function loadAdminCategoryView(){
      const categories = Object.keys(itemsData);
      adminCategoryView.innerHTML = categories.map(cat=>{
        const items = itemsData[cat]||[];
        const hiddenCount = items.filter(it=>hiddenItems.has(`${cat}-${it.name}`)).length;
        const visibleCount = items.length - hiddenCount;
        return `<div class="admin-category-item border-3 border-gray-200 rounded-xl p-6 text-center" onclick="showAdminCategoryItems('${cat}')">
          <div class="text-4xl mb-4">${getDefaultEmoji(cat)}</div>
          <span class="font-bold text-lg">${cat}</span>
          <div class="text-sm text-gray-600 mt-2"><div class="text-green-600 font-medium">${visibleCount} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á</div>${hiddenCount?`<div class="text-red-600 font-medium">${hiddenCount} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏ô</div>`:''}</div>
        </div>`;
      }).join('');
    }
    function showAdminCategoryItems(category){
      adminCurrentCategory=category; adminCategoryView.classList.add('hidden'); adminItemsView.classList.remove('hidden'); adminCategoryTitle.textContent=category;
      const items = itemsData[category]||[];
      adminItemsList.innerHTML = items.map(item=>{
        const key = `${category}-${item.name}`, isHidden = hiddenItems.has(key);
        return `<div class="admin-item-card bg-white border-2 rounded-xl p-6 ${isHidden?'hidden-item border-red-300':'border-gray-200'}">
          <div class="text-center">
            ${item.image && /^https?:/.test(item.image) ? `<img src="${item.image}" alt="${item.name}" class="w-24 h-24 mx-auto mb-4 object-contain rounded-lg border" onerror="this.style.display='none'">` : `<div class="text-3xl mb-4">${item.image||'üì¶'}</div>`}
            <h4 class="font-bold text-lg mb-2">${item.name}</h4>
            ${item.description?`<p class="text-gray-600 text-sm mb-2">${item.description}</p>`:''}
            <p class="text-emerald-600 font-bold text-lg mb-4">${item.price} ‡∏ö‡∏≤‡∏ó/${item.unit||'‡∏ä‡∏¥‡πâ‡∏ô'}</p>
            <button onclick="toggleItemVisibility('${category}','${item.name}')" class="hide-button w-full py-3 px-4 rounded-lg font-bold text-lg ${isHidden?'bg-green-500 hover:bg-green-600':'bg-red-500 hover:bg-red-600'} text-white">${isHidden?'‚úì ‡πÅ‡∏™‡∏î‡∏á':'‚úï ‡∏ã‡πà‡∏≠‡∏ô'}</button>
            ${isHidden?'<div class="mt-3 text-red-600 font-medium text-sm">üö´ ‡∏ã‡πà‡∏≠‡∏ô‡∏à‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</div>':''}
          </div>
        </div>`;
      }).join('');
    }
    function backToAdminCategories(){ adminCategoryView.classList.remove('hidden'); adminItemsView.classList.add('hidden'); adminCurrentCategory=''; loadAdminCategoryView() }
    function getDefaultEmoji(cat){ const m={'‡πÅ‡∏ü‡πâ‡∏°‡πÅ‡∏•‡∏∞‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö':'üìÅ','‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ï‡∏±‡∏î':'‚úÇÔ∏è','‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏à‡∏≤‡∏∞':'üï≥Ô∏è','‡∏Ñ‡∏•‡∏¥‡∏õ‡∏´‡∏ô‡∏µ‡∏ö‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©':'üìé','‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô':'‚úèÔ∏è','‡∏™‡∏Å‡∏≠‡∏ï‡πÄ‡∏ó‡∏õ,‡∏Å‡∏≤‡∏ß‡πÅ‡∏•‡∏∞‡πÇ‡∏û‡∏™‡∏≠‡∏¥‡∏ó':'üè∑Ô∏è','‡∏ñ‡πà‡∏≤‡∏ô':'üîã','‡∏ã‡∏≠‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£':'üìÆ','‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î':'üßΩ','‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°':'‚òï','‡∏≠‡∏∑‡πà‡∏ô‡πÜ':'üì¶'}; return m[cat]||'üì¶' }
    function toggleItemVisibility(category,name){
      const key=`${category}-${name}`; if(hiddenItems.has(key)) hiddenItems.delete(key); else hiddenItems.add(key);
      localStorage.setItem('hiddenItems', JSON.stringify([...hiddenItems]));
      if(adminCurrentCategory===category && !adminItemsView.classList.contains('hidden')) showAdminCategoryItems(category);
      if(!adminCategoryView.classList.contains('hidden')) loadAdminCategoryView();
      if(!categoryView.classList.contains('hidden')) updateCategoryView();
      if(currentCategory===category && !itemsView.classList.contains('hidden')) showCategoryItems(category);
    }

    /* ======= USER FLOW ======= */
    function goToPage(n){ for(let i=1;i<=4;i++) document.getElementById(`page${i}`).classList.add('hidden'); successPage.classList.add('hidden'); document.getElementById(`page${n}`).classList.remove('hidden') }
    function selectCompany(ev,company){
      selectedCompany=company;
      document.querySelectorAll('.company-card').forEach(c=>c.classList.remove('selected'));
      ev.currentTarget.classList.add('selected');
      nextBtn2.disabled=false; nextBtn2.classList.remove('opacity-50','cursor-not-allowed');
      loadProductData();
    }

    async function loadProductData(){
      try{
        const sheet = selectedCompany==='BigC' ? 'Prod BigC' : 'Prod BJC';
        const r = await fetch(`${GAS_WEB_APP_URL}?action=getProducts&company=${encodeURIComponent(selectedCompany)}&sheet=${encodeURIComponent(sheet)}`);
        const d = await r.json();
        if(d.success){ itemsData=d.products; updateCategoryView(); } else { loadFallbackData(); updateCategoryView(); }
      }catch(_){ loadFallbackData(); updateCategoryView(); }
    }

    function updateCategoryView(){
      document.querySelectorAll('.category-item').forEach(el=>{
        const m = el.getAttribute('onclick').match(/'([^']+)'/); if(!m) return;
        const cat = m[1]; const items=itemsData[cat]||[]; const visible=items.filter(it=>!hiddenItems.has(`${cat}-${it.name}`));
        const countEl = el.querySelector('.text-sm.text-gray-500.mt-2'); if(countEl) countEl.textContent = `${visible.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`;
      });
    }

    function showCategoryItems(category){
      currentCategory=category; categoryView.classList.add('hidden'); itemsView.classList.remove('hidden'); categoryTitle.textContent=category;
      const items = (itemsData[category]||[]).filter(it=>!hiddenItems.has(`${category}-${it.name}`));
      itemsList.innerHTML = items.map(item=>{
        const key = item.name.replace(/\s+/g,'');
        return `<div class="item-card bg-white border-2 border-gray-200 rounded-xl p-6" onclick="toggleItem(event,'${category}','${item.name}',${item.price},'${item.unit||'‡∏ä‡∏¥‡πâ‡∏ô'}')">
          <div class="text-center">
            ${item.image && /^https?:/.test(item.image) ? `<img src='${item.image}' alt='${item.name}' class='w-32 h-32 mx-auto mb-4 object-contain rounded-lg border' onerror="this.style.display='none'">` : `<div class='text-4xl mb-4'>${item.image||'üì¶'}</div>`}
            <h4 class="font-bold text-lg mb-2">${item.name}</h4>
            ${item.description?`<p class="text-gray-600 text-sm mb-2">${item.description}</p>`:''}
            <p class="text-emerald-600 font-bold text-xl mb-2">${item.price} ‡∏ö‡∏≤‡∏ó/${item.unit||'‡∏ä‡∏¥‡πâ‡∏ô'}</p>
            <div id="quantity-${key}" class="quantity-input hidden">
              <label class="block text-sm font-medium text-gray-700 mb-2">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô (${item.unit||'‡∏ä‡∏¥‡πâ‡∏ô'})</label>
              <input type="number" min="1" value="1" class="w-full px-3 py-2 border rounded-lg focus:border-emerald-500"
                onchange="updateQuantity('${category}','${item.name}',${item.price},this.value,'${item.unit||'‡∏ä‡∏¥‡πâ‡∏ô'}')">
              <div class="mt-2 text-sm text-emerald-600 font-semibold">‡∏£‡∏ß‡∏°: <span id="total-${key}">${item.price}</span> ‡∏ö‡∏≤‡∏ó</div>
            </div>
          </div>
        </div>`;
      }).join('');
    }
    function backToCategories(){ categoryView.classList.remove('hidden'); itemsView.classList.add('hidden') }

    function toggleItem(ev,category,name,price,unit){
      const key=`${category}-${name}`; const qdiv=document.getElementById(`quantity-${name.replace(/\s+/g,'')}`); const card=ev.currentTarget;
      if(selectedItems[key]){ delete selectedItems[key]; card.classList.remove('selected'); qdiv.classList.add('hidden'); }
      else { selectedItems[key]={category,name,price,unit,quantity:1,total:price}; card.classList.add('selected'); qdiv.classList.remove('hidden'); }
      updateNextButton(); updateSummary();
    }

    function updateQuantity(category,name,price,quantity,unit){
      const key=`${category}-${name}`; const qty=parseInt(quantity)||1; const total=price*qty;
      if(selectedItems[key]){ selectedItems[key].quantity=qty; selectedItems[key].total=total; selectedItems[key].unit=unit; }
      document.getElementById(`total-${name.replace(/\s+/g,'')}`).textContent=total; updateSummary();
    }

    function updateNextButton(){
      if(Object.keys(selectedItems).length>0){ nextBtn3.disabled=false; nextBtn3.classList.remove('opacity-50','cursor-not-allowed'); }
      else { nextBtn3.disabled=true; nextBtn3.classList.add('opacity-50','cursor-not-allowed'); }
    }

    function updateSummary(){
      const div=selectedItemsDiv, totalSpan=totalPrice;
      if(!Object.keys(selectedItems).length){ div.innerHTML='<p class="text-gray-600 text-lg">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</p>'; totalSpan.textContent='0'; return }
      const groups={}; let grand=0;
      Object.values(selectedItems).forEach(it=>{ groups[it.category]??={items:[],sum:0}; groups[it.category].items.push(it); groups[it.category].sum+=it.total; grand+=it.total; });
      let html='<div class="space-y-6">';
      Object.entries(groups).forEach(([cat,g])=>{
        html+=`<div class="border-b border-emerald-200 pb-4"><h4 class="font-bold text-lg text-emerald-800 mb-3">${cat}</h4><div class="space-y-2 ml-4">`;
        g.items.forEach(it=>{ html+=`<div class="flex justify-between items-center text-sm"><span class="text-gray-700">${it.name}</span><div class="text-right"><div class="text-gray-600">${it.quantity} ${it.unit} √ó ${it.price} ‡∏ö‡∏≤‡∏ó</div><div class="font-semibold text-emerald-600">${it.total} ‡∏ö‡∏≤‡∏ó</div></div></div>`; });
        html+=`</div><div class="text-right mt-3 font-bold text-emerald-700">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ß‡∏° ${cat}: ${g.sum.toLocaleString()} ‡∏ö‡∏≤‡∏ó</div></div>`;
      });
      html+='</div>'; div.innerHTML=html; totalSpan.textContent=grand.toLocaleString();
    }

    async function submitForm(ev){
      const employeeId = document.getElementById('employeeId').value.trim();
      const remarks = document.getElementById('remarks').value.trim();
      if(!employeeId){ alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô'); return }
      const btn=ev.currentTarget, old=btn.innerHTML; btn.disabled=true; btn.innerHTML='‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á...';
      try{
        const res = await fetch(GAS_WEB_APP_URL, {
          method:'POST',
          headers:{'Content-Type':'text/plain;charset=utf-8'},
          body: JSON.stringify({ action:'submitForm', company:selectedCompany, items:selectedItems, employeeId, remarks, totalPrice: totalPrice.textContent, timestamp:new Date().toISOString() })
        });
        const out = await res.json();
        if(out.success){ page4.classList.add('hidden'); successPage.classList.remove('hidden'); }
        else { alert('‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: '+(out.error||'')); }
      }catch(e){ alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠'); }
      finally{ btn.disabled=false; btn.innerHTML=old; }
    }

    function resetForm(){
      selectedCompany=''; selectedItems={}; currentCategory='';
      document.getElementById('employeeId').value=''; document.getElementById('remarks').value='';
      document.querySelectorAll('.company-card').forEach(c=>c.classList.remove('selected'));
      nextBtn2.disabled=true; nextBtn2.classList.add('opacity-50','cursor-not-allowed');
      nextBtn3.disabled=true; nextBtn3.classList.add('opacity-50','cursor-not-allowed');
      backToCategories(); goToPage(1);
    }

    function loadHiddenItems(){
      const saved=localStorage.getItem('hiddenItems'); if(saved) hiddenItems=new Set(JSON.parse(saved));
    }

    function loadFallbackData(){
      // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á (‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏°‡∏∑‡πà‡∏≠ backend ‡∏ï‡∏≠‡∏ö)
      itemsData={
        '‡πÅ‡∏ü‡πâ‡∏°‡πÅ‡∏•‡∏∞‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö':[
          {name:'‡∏•‡∏¥‡πâ‡∏ô‡πÅ‡∏ü‡πâ‡∏°‡∏≠‡∏∞‡∏•‡∏π‡∏°‡∏¥‡πÄ‡∏ô‡∏µ‡∏¢‡∏°‡∏£‡∏∏‡πà‡∏ô223',price:45,image:'https://i.postimg.cc/c4LbLsfS/T8-223.jpg',unit:'‡∏ä‡∏¥‡πâ‡∏ô',description:'‡∏•‡∏¥‡πâ‡∏ô‡πÅ‡∏ü‡πâ‡∏°‡∏≠‡∏∞‡∏•‡∏π‡∏°‡∏¥‡πÄ‡∏ô‡∏µ‡∏¢‡∏°‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏î‡∏µ'},
          {name:'‡πÅ‡∏ü‡πâ‡∏°‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ A4',price:35,image:'üìÇ',unit:'‡πÄ‡∏•‡πà‡∏°'}
        ],
        '‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô':[
          {name:'‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏•‡∏π‡∏Å‡∏•‡∏∑‡πà‡∏ô‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô',price:12,image:'üñäÔ∏è',unit:'‡∏î‡πâ‡∏≤‡∏°'},
          {name:'‡∏î‡∏¥‡∏ô‡∏™‡∏≠ HB',price:8,image:'‚úèÔ∏è',unit:'‡πÅ‡∏ó‡πà‡∏á'}
        ],
        '‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ï‡∏±‡∏î':[
          {name:'‡∏Å‡∏£‡∏£‡πÑ‡∏Å‡∏£',price:30,image:'‚úÇÔ∏è',unit:'‡∏Ñ‡∏π‡πà'},
          {name:'‡∏°‡∏µ‡∏î‡∏Ñ‡∏±‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡πå',price:20,image:'üî™',unit:'‡∏î‡πâ‡∏≤‡∏°'}
        ]
      };
    }

    // Init
    window.addEventListener('load', ()=>{ loadHiddenItems(); });

  </script>
</body>
</html>
