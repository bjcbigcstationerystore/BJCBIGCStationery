<!DOCTYPE html>
<html lang="th">
<head>
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>BJC Big C Stationery Store</title>
  <link rel="icon" type="image/svg+xml"
  href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><text y='14' font-size='14'>üõí</text></svg>'" />
    
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    #summaryContent .form-value ul{ margin:0; padding-left:1.25rem; }
#summaryContent .form-value li{ line-height:1.45; }
    
    :root{
      --emerald-900:#064e3b;
      --emerald-800:#065f46;
      --emerald-700:#047857;
      --emerald-600:#059669;
      --emerald-500:#10b981;
      --logo-h:32px;
    }
    html,body{
  height:100%;
  margin:0;
  font-family:'Prompt', system-ui, -apple-system, Segoe UI, Roboto, 'Helvetica Neue', Arial, sans-serif;
  background:#ffffff;
  color:#0f172a;
}
    
   /* ‚úÖ ‡∏´‡∏ô‡πâ‡∏≤ verify ‡πÉ‡∏´‡πâ‡∏ï‡∏±‡∏î‡∏Å‡∏£‡∏≠‡∏ö/‡πÄ‡∏á‡∏≤/ padding ‡∏Ç‡∏≠‡∏á .content-card ‡∏ó‡∏¥‡πâ‡∏á */
body.verify .content-card{
  background:transparent !important;
  box-shadow:none !important;
  padding:0 !important;
  max-width:none !important;
}
    
   /* Top App Bar */
.appbar{
  position:fixed; inset:0 0 auto 0; height:56px;
  background:#065f46; color:#ecfdf5; z-index:10000;
  box-shadow:0 6px 18px rgba(0,0,0,.18);
}
.appbar-inner{
  height:100%; display:flex; align-items:center; gap:10px;
  padding:0 14px;
}
    /* ‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏°‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß ‡∏Ç‡∏≠‡∏ö‡πÇ‡∏Ñ‡πâ‡∏á + ‡πÄ‡∏á‡∏≤ */
.appbar-logo{
  display:inline-flex; 
  align-items:center; 
  justify-content:center;
  padding:6px 10px;                         /* ‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏£‡∏≠‡∏ö‡πÇ‡∏•‡πÇ‡∏Å‡πâ */
  background:#ffffff;                      /* ‡∏Å‡∏£‡∏≠‡∏ö‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß */
  border:1px solid rgba(255,255,255,.35);  /* ‡πÄ‡∏™‡πâ‡∏ô‡∏Ç‡∏≠‡∏ö‡∏ö‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πà‡∏á */
  border-radius:12px;                      /* ‡∏Ç‡∏≠‡∏ö‡πÇ‡∏Ñ‡πâ‡∏á */
  box-shadow:0 6px 14px rgba(0,0,0,.12);   /* ‡πÄ‡∏á‡∏≤‡∏≠‡πà‡∏≠‡∏ô */
  max-height:36px;                         /* ‡∏Ñ‡∏∏‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡πÉ‡∏´‡πâ‡∏û‡∏≠‡∏î‡∏µ‡πÅ‡∏ñ‡∏ö */
}

.appbar-logo-img{
  height:30px;                             /* ‡∏Ç‡∏ô‡∏≤‡∏î‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô */
  width:auto;
  display:block;
}
    

/* ‡∏Å‡∏±‡∏ô App Bar ‡∏ó‡∏±‡∏ö‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ */
.page-container{
  display:flex; justify-content:center; width:100%; min-height:100vh;
  padding:calc(56px + 1.25rem) 1rem 2rem;   /* ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô */
}
    .page-container.centered{align-items:center}.page-container.top{align-items:flex-start}
    .content-card{position:relative;background:rgba(255,255,255,.96);border-radius:20px;box-shadow:0 20px 40px rgba(0,0,0,.15);width:100%;max-width:900px;backdrop-filter:blur(10px);padding:2.5rem;color:#111827}
    body.category .content-card,
body.products .content-card,
body.summary .content-card{
  padding:0!important;
  background:transparent!important;
  box-shadow:none!important;
  max-width:900px;
}
    .category-inner,.products-inner{max-width:900px;margin:0 auto}
    @media (max-width:1024px){ .category-inner,.products-inner{max-width:100%} }
    .corner-logo{display:none}
    body.not-home .corner-logo{display:block}
    .corner-logo{height:var(--logo-h)!important;width:auto!important}
    .logo-box img{height:var(--logo-h);width:auto;display:block}
    .btn-primary{background:linear-gradient(135deg,var(--emerald-500),var(--emerald-600));transition:.25s}
    .btn-primary:hover{background:linear-gradient(135deg,var(--emerald-600),var(--emerald-700));transform:translateY(-2px);box-shadow:0 10px 25px rgba(16,185,129,.3)}
    .alert-success{background:#ecfdf5;border:1px solid #bbf7d0;color:#065f46;border-radius:12px}

    /* hero panel reused */
    .green-shell{position:relative;border-radius:20px;padding:0;background: linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,.015)), linear-gradient(180deg,#1b4e41 0%,#1c5b4a 40%,#165846 100%);overflow:hidden}
    .hero{position:relative;margin:0;padding:22px 24px 24px;text-align:center;color:#ecfdf5;background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02)), linear-gradient(180deg,#3a7a68 0%,#2f6f60 55%,#2b6758 100%)}
    .hero-title{font-size:2rem;font-weight:800;margin:0}
    .hero-sub{margin-top:2px;font-size:.95rem;letter-spacing:.25rem;opacity:.95}
    .hero-dots{display:flex;gap:.65rem;justify-content:center;align-items:center;margin:.5rem 0 .85rem}
    .hero-dots span{width:8px;height:8px;border-radius:9999px;background:#ffffffcc}.hero-dots .dim{opacity:.35}
    .hero-desc{font-weight:800;color:#f2fff7}
    .logo-box{position:absolute;top:14px;right:18px;background:#fff;border-radius:12px;padding:6px 10px;box-shadow:0 3px 8px rgba(0,0,0,.2);display:flex;align-items:center;gap:4px}
    .panel{background:#fff;border-radius:0 0 20px 20px;box-shadow:0 15px 35px rgba(0,0,0,.18);overflow:hidden;margin:0;position:relative}
    .panel-head{background:linear-gradient(180deg,#f0fdf4,#ecfdf5);border-bottom:1px solid #d9f3e5;padding:22px 28px}
    .panel-body{padding:24px 24px 100px}

    /* ‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏•‡∏±‡∏ö (‡πÅ‡∏ö‡∏ö‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô/‡∏´‡∏°‡∏ß‡∏î) */
    .back-btn{
      position:absolute;bottom:18px;right:28px;background:#fff;border:1px solid #e5e7eb;
      border-radius:9999px;padding:.6rem 1rem;display:flex;align-items:center;gap:6px;
      color:var(--emerald-700);font-weight:700;box-shadow:0 8px 18px rgba(0,0,0,.08);
      transition:transform .15s, box-shadow .15s;
    }
    .back-btn:hover{transform:translateX(-2px);box-shadow:0 12px 24px rgba(0,0,0,.12)}

    /* ‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏´‡∏°‡∏ß‡∏î/‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ */
    .cat-item, .prod-card{
      background:#fff;border:1px solid #e5e7eb;border-left-width:4px;border-left-color:#e5e7eb;border-radius:16px;
      padding:14px; /* ‡∏•‡∏î padding ‡πÉ‡∏´‡πâ‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏î‡∏π‡πÄ‡∏•‡πá‡∏Å‡∏•‡∏á */
      transition:all .2s;text-align:center;cursor:pointer
    }
    .cat-item:hover,.cat-item:focus,.prod-card:hover{
      background:#f0fdf4;border-left-color:var(--emerald-700);
      box-shadow:0 10px 22px rgba(0,0,0,.06);transform:translateY(-1px)
    }
    body.products .prod-card{
      border-left-width: 1px !important; /* ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Ç‡∏≠‡∏ö‡∏´‡∏ô‡∏≤‡∏î‡πâ‡∏≤‡∏ô‡∏ã‡πâ‡∏≤‡∏¢ */
      border-left-color: #e5e7eb !important; /* ‡πÉ‡∏´‡πâ‡∏ã‡πâ‡∏≤‡∏¢‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏ó‡∏≤‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏î‡πâ‡∏≤‡∏ô‡∏≠‡∏∑‡πà‡∏ô */
    }
    body.products .prod-card:hover{
      border-color: var(--emerald-700) !important; /* ‡πÄ‡∏ß‡∏•‡∏≤ hover ‡πÉ‡∏´‡πâ‡∏Ç‡∏≠‡∏ö‡∏ó‡∏±‡πâ‡∏á‡πÉ‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡πÄ‡∏Ç‡πâ‡∏° */
      /* ‡∏ã‡πâ‡∏≥‡πÉ‡∏´‡πâ‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ß‡πà‡∏≤‡∏î‡πâ‡∏≤‡∏ô‡∏ã‡πâ‡∏≤‡∏¢‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏î‡πâ‡∏ß‡∏¢ (‡∏Å‡∏±‡∏ô‡πÄ‡∏Ñ‡∏™ rule ‡πÄ‡∏Å‡πà‡∏≤‡∏°‡∏≤ override) */
      border-left-color: var(--emerald-700) !important;
    }

    /* ‡∏£‡∏π‡∏õ‡πÉ‡∏´‡∏ç‡πà‡∏Ç‡∏∂‡πâ‡∏ô */
    .prod-img{
      width:112px;height:112px;object-fit:contain;
      margin:0 auto 10px;border-radius:12px;background:#f8fafc
    }

    /* Modal */
    .modal-mask{position:fixed;inset:0;background:rgba(0,0,0,.45);display:none;align-items:center;justify-content:center;z-index:9999}
    .modal{background:#fff;border-radius:18px;max-width:520px;width:92%;padding:22px 22px 20px;box-shadow:0 25px 60px rgba(0,0,0,.25)}
    .qty-btn{width:38px;height:38px;border-radius:9999px;border:1px solid #e5e7eb;background:#fff;font-weight:800}
    .price-green{color:#059669;font-weight:800}

    /* ===== Cart floating button + badge ===== */
    .cart-btn{
      position:absolute;
      top:72px;
      right:18px;
      width:56px;
      height:56px;
      border-radius:16px;
      background:linear-gradient(180deg,#0f5b46,#0e4f3e);
      box-shadow:0 12px 28px rgba(0,0,0,.25), inset 0 1px 0 rgba(255,255,255,.08);
      display:none;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      z-index: 50; /* ‚¨ÖÔ∏è ‡∏Å‡∏±‡∏ô‡∏ñ‡∏π‡∏Å hero/panel ‡∏ó‡∏±‡∏ö */
    }
    .cart-btn.show{ display:flex; } /* ‡∏à‡∏∞‡πÇ‡∏ä‡∏ß‡πå‡∏ï‡πà‡∏≠‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Ñ‡∏•‡∏≤‡∏™ .show ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô */
    .cart-btn svg{ width:28px; height:28px; color:#ecfdf5; }
    .cart-badge{
      position:absolute;
      top:-6px;
      right:-6px;
      min-width:22px;
      height:22px;
      padding:0 6px;
      display:flex;
      align-items:center;
      justify-content:center;
      background:linear-gradient(135deg,#ff4da0,#ff7a59);
      color:#fff;
      font-weight:800;
      font-size:.8rem;
      border-radius:9999px;
      box-shadow:0 6px 14px rgba(0,0,0,.25);
    }

    /* ===== Cart Drawer (‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏£‡∏∏‡∏õ) ===== */
    .cart-mask{ position:fixed; inset:0; z-index:9998; background:rgba(0,0,0,.45); display:none; }
    .cart-mask.show{ display:block; }
    .cart-panel{
      position:fixed; right:0; top:0; bottom:0; width:360px; max-width:90%;
      display:flex; flex-direction:column; background:#f1f8f4; box-shadow:-16px 0 48px rgba(0,0,0,.25);
    }
    .cart-header{
      padding:18px; background:linear-gradient(180deg,#1e6a57,#155844); color:#ecfdf5; position:relative;
    }
    .cart-header .icon{
      width:60px; height:60px; border-radius:18px; background:linear-gradient(180deg,#0f5b46,#0e4f3e);
      display:flex; align-items:center; justify-content:center; position:absolute; right:18px; top:18px;
    }
    .cart-header .icon svg{ width:30px; height:30px; color:#ecfdf5; }
    .cart-header .icon .cart-badge{ top:-6px; right:-6px; }
    .cart-body{ flex:1 1 auto; padding:14px; overflow:auto; display:flex; flex-direction:column; gap:10px; }
    .cart-footer{
      position:sticky; /* ‡πÉ‡∏´‡πâ‡∏Ñ‡πâ‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏Å‡πâ‡∏ô‡∏Ç‡∏ì‡∏∞‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô */
      bottom:0; flex:0 0 auto; background:#e7f4ee; padding:14px; border-top:1px solid #cfe9de;
      box-shadow:0 -6px 12px rgba(0,0,0,.05); z-index:1;
    }
    /* ‡πÅ‡∏ñ‡∏ö "‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î" ‡∏à‡∏±‡∏î‡∏™‡∏≠‡∏á‡∏ù‡∏±‡πà‡∏á‡∏û‡∏≠‡∏î‡∏µ */
    .cart-total{ display:flex; align-items:baseline; justify-content:space-between; gap:12px; font-weight:700; font-size:.95rem; }
    .cart-total span:last-child{ font-weight:800; font-size:1.05rem; color:#10b981; /* ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏Ç‡∏≠‡∏á‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏° */ }
    /* ‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡∏π‡πà: ‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô ‡πÑ‡∏°‡πà‡∏ö‡∏¥‡∏î‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ß */
    .cart-actions{ display:flex; gap:10px; margin-top:10px; }
    .cart-actions .cart-btn-secondary, .cart-actions .cart-btn-primary{
      flex:1 1 0; /* ‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡πÄ‡∏ó‡πà‡∏≤ ‡πÜ ‡∏Å‡∏±‡∏ô */
      display:inline-flex; align-items:center; justify-content:center; min-height:44px; /* ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏Ñ‡∏á‡∏ó‡∏µ‡πà */
      padding:12px 14px; border:none; border-radius:12px; font-weight:800; font-size:.95rem; line-height:1; text-decoration:none;
    }
    .cart-actions .cart-btn-secondary{ background:#374151; color:#fff; }
    .cart-actions .cart-btn-primary{ background:#065f46; color:#fff; }

    /* ‡∏à‡∏≠‡πÄ‡∏•‡πá‡∏Å‡∏°‡∏≤‡∏Å: ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ */
    @media (max-width:380px){
      .cart-actions{ flex-direction:column; gap:8px; }
      .cart-actions .cart-btn-secondary, .cart-actions .cart-btn-primary{ width:100%; }
    }

    /* ‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤ */
    .cart-item{
      display:grid; grid-template-columns: 1fr auto; gap:10px; background:#f9fefb;
      border:1px solid #e6f5ea; border-radius:14px; padding:10px 12px; box-shadow:0 6px 14px rgba(0,0,0,.04);
    }
    /* ‡∏ù‡∏±‡πà‡∏á‡∏ã‡πâ‡∏≤‡∏¢: ‡∏£‡∏π‡∏õ + ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• */
    .cart-item .left{ display:flex; align-items:center; gap:8px; min-width:0; }
    .cart-item .thumb{
      width:38px; height:38px; flex:0 0 38px; border-radius:8px; background:#f8fafc; object-fit:contain; box-shadow:inset 0 0 0 1px #eef2f7;
    }
    .cart-item .info{ display:flex; flex-direction:column; min-width:0; }
    .cart-item .name{
      font-weight:600; /* ‡πÄ‡∏î‡∏¥‡∏° 700 ‚Üí ‡∏•‡∏î‡∏•‡∏á */
      font-size:.9rem; /* ‡πÄ‡∏î‡∏¥‡∏° .95rem ‚Üí ‡πÄ‡∏•‡πá‡∏Å‡∏•‡∏á */
      line-height:1.2; color:#0f172a; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }
    .cart-item .desc{
      font-size:.78rem; /* ‡πÄ‡∏•‡πá‡∏Å‡∏•‡∏á‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ */
      color:#6b7280; line-height:1.15; margin-top:2px; display:block;
    }
    .cart-item .meta{
      font-weight:600; /* ‡πÄ‡∏î‡∏¥‡∏° 700 ‚Üí ‡∏•‡∏î‡∏•‡∏á */
      font-size:.85rem; color:#059669; margin-top:1px;
    }
    /* ‡∏ù‡∏±‡πà‡∏á‡∏Ç‡∏ß‡∏≤: ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô + ‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏ö‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á */
    .cart-item .right{ display:flex; flex-direction:column; align-items:flex-end; justify-content:space-between; }
    .cart-item .line{ font-weight:700; /* ‡πÄ‡∏î‡∏¥‡∏° 800 ‚Üí ‡∏•‡∏î‡∏•‡∏á */ font-size:.95rem; /* ‡πÄ‡∏î‡∏¥‡∏° 1rem ‚Üí ‡πÄ‡∏•‡πá‡∏Å‡∏•‡∏á */ color:#10b981; }
    .cart-item .remove{
      margin-top:8px; background:#ffe6e9; color:#b91c1c; font-weight:600; /* ‡πÄ‡∏î‡∏¥‡∏° 800 ‚Üí ‡∏•‡∏î‡∏•‡∏á */
      border:none; border-radius:9999px; padding:.25rem .7rem; font-size:.8rem; /* ‡πÄ‡∏î‡∏¥‡∏° .85rem ‚Üí ‡πÄ‡∏•‡πá‡∏Å‡∏•‡∏á */
    }

    /* Summary list (‡πÉ‡∏´‡∏°‡πà) */
    .sum-item{
      display:grid; grid-template-columns: 1fr auto; gap:10px; background:#ffffff; border:1px solid #e5e7eb;
      border-radius:14px; padding:12px 14px; box-shadow:0 6px 14px rgba(0,0,0,.04);
    }
    .sum-item .name{ font-weight:700; color:#0f172a; line-height:1.2; }
    .sum-item .desc{ font-size:.85rem; color:#6b7280; margin-top:2px; }
    .sum-item .meta{ color:#059669; font-weight:700; margin-top:1px; }
    .sum-item .line{ color:#10b981; font-weight:800; }
    
/* ===== Summary: Employee grid (‡∏Ñ‡∏π‡πà‡∏ã‡πâ‡∏≤‡∏¢-‡∏Ç‡∏ß‡∏≤) ===== */
.emp-grid {
  display:grid; grid-template-columns: 1fr 1fr; gap:10px;
}
.emp-cell{
  display:flex; align-items:center; justify-content:space-between;
  padding:10px 12px; border:1px dashed #e5e7eb; border-radius:10px;
}
.emp-cell .field-label{ color:#6b7280; font-weight:700; }
.emp-cell .field-value{ color:#0f172a; font-weight:700; }

/* ===== Summary: Items table ===== */
.sum-table{
  width:100%; border-collapse:separate; border-spacing:0; overflow:hidden;
  border:1px solid #e5e7eb; border-radius:14px; background:#fff;
}
.sum-table thead th{
  background:#f8fafc; color:#111827; font-weight:800; text-align:left;
  padding:14px 16px; border-bottom:1px solid #e5e7eb;
}
.sum-table tbody td{
  padding:14px 16px; border-bottom:1px solid #e5e7eb; vertical-align:middle;
}
.sum-table tfoot td{
  padding:14px 16px; background:#ecfdf5; font-weight:900; color:#065f46;
}
.sum-col-idx{ width:68px; text-align:center; }
.sum-col-qty{ width:100px; text-align:center; }
.sum-col-unit{ width:140px; text-align:right; white-space:nowrap; }
.sum-col-line{ width:160px; text-align:right; white-space:nowrap; }
.sum-itembox{ display:flex; gap:10px; align-items:flex-start; }
.sum-thumb{
  width:34px; height:34px; border-radius:8px; background:#f1f5f9;
  object-fit:contain; box-shadow:inset 0 0 0 1px #e5e7eb;
}
.sum-name{ font-weight:800; color:#0f172a; line-height:1.2; }
.sum-desc{ font-size:.85rem; color:#6b7280; margin-top:2px; }    
  
/* ===== Summary: Field layout like sample #2 ===== */
#summaryContent .form-grid{
  display:grid; grid-template-columns:1fr 1fr; gap:16px;
}
#summaryContent .form-field{
  display:flex; flex-direction:column; gap:8px;
}
#summaryContent .form-label{
  color:#4b5563; font-weight:700;
}
#summaryContent .form-value{
  background:#fff; border:1px solid #e5e7eb; border-radius:12px;
  padding:14px 16px; color:#0f172a;
  /* ‡πÉ‡∏™‡πà‡πÄ‡∏á‡∏≤‡πÄ‡∏ö‡∏≤‡πÜ (‡∏à‡∏∞‡πÄ‡∏≠‡∏≤‡∏≠‡∏≠‡∏Å‡∏Å‡πá‡πÑ‡∏î‡πâ) */
  box-shadow:inset 0 0 0 1px #eef2f7;
}

/* ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠: ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß */
@media (max-width:768px){
  #summaryContent .form-grid{ grid-template-columns:1fr; }
}

/* ==== Summary: ‡πÉ‡∏´‡πâ label ‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏ô ‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏Ñ‡∏±‡πà‡∏ô‡πÉ‡∏ô‡∏î‡πâ‡∏≤‡∏ô‡πÉ‡∏ô‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ñ‡πà‡∏≤ ==== */
#summaryContent .field-row{
  display:flex;
  flex-direction:column;
  align-items:stretch;
  gap:.45rem;
  border-bottom:0;
  padding:.35rem 0;
}
#summaryContent .field-label{
  display:block; color:#374151; font-weight:600;
}
#summaryContent .field-value{
  display:block; background:#fff; padding:.9rem 1rem;
  border:1px solid #e5e7eb; border-radius:12px;
  box-shadow:inset 0 0 0 1px #eef2f7;
  color:#0f172a; font-weight:700;
}
 
    /* FORCE inner padding for Summary boxes */
#summaryContent .form-value,
#summaryContent .field-value{
  background:#fff !important;
  border:1px solid #e5e7eb !important;
  border-radius:12px !important;
  padding:14px 18px !important;   /* << ‡πÄ‡∏ß‡πâ‡∏ô‡∏Ç‡∏≠‡∏ö‡∏î‡πâ‡∏≤‡∏ô‡πÉ‡∏ô */
  display:block !important;
  box-sizing:border-box !important;
  line-height:1.5 !important;
  color:#0f172a !important;
  font-weight:800 !important;
}

/* ‡πÉ‡∏´‡πâ layout ‡πÄ‡∏õ‡πá‡∏ô 2 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå (‡∏ñ‡πâ‡∏≤‡πÇ‡∏î‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏∑‡πà‡∏ô‡∏ó‡∏±‡∏ö) */
#summaryContent .form-grid{
  display:grid !important;
  grid-template-columns:1fr 1fr !important;
  gap:16px !important;
}
#summaryContent .form-field{
  display:flex !important;
  flex-direction:column !important;
  gap:8px !important;
}
#summaryContent .form-label{
  color:#4b5563 !important;
  font-weight:700 !important;
}

/* ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß */
@media (max-width:768px){
  #summaryContent .form-grid{ grid-template-columns:1fr !important; }
}

    /* ============= FINAL OVERRIDE ============= */
#summaryContent .panel .panel-body .form-grid .form-field > .form-value,
#summaryContent .panel .panel-body .form-grid .form-field > #s_company.form-value,
#summaryContent .panel .panel-body .form-grid .form-field > #s_cost.form-value,
#summaryContent .panel .panel-body .form-grid .form-field > #s_empid.form-value,
#summaryContent .panel .panel-body .form-grid .form-field > #s_fullname.form-value,
#summaryContent .panel .panel-body .form-grid .form-field > #s_bu_name.form-value,
#summaryContent .panel .panel-body .form-grid .form-field > #s_bu_email.form-value{
  background:#fff !important;
  border:1px solid #e5e7eb !important;
  border-radius:12px !important;
  padding:14px 16px !important;
  box-sizing:border-box !important;
  line-height:1.45 !important;
  font-weight:400 !important;   /* ‚Üê ‡πÑ‡∏°‡πà‡∏°‡∏µ ** */
}
    #summaryContent .form-label{ font-size:.9rem !important; font-weight:600 !important; }
#summaryContent .dot + h4{ font-size:1.2rem !important; line-height:1.25 !important; }

/* ‡∏Å‡∏±‡∏ô‡πÄ‡∏Ñ‡∏™‡πÇ‡∏î‡∏ô‡∏ï‡∏±‡πâ‡∏á display:flex ‡∏°‡∏≤ */
#summaryContent .form-value *{
  line-height:inherit !important;
}
  /* ===== Summary: tighten text inside employee/BU blocks only ===== */
#summaryContent .panel-body .dot + h4{
  font-size: 1.25rem !important;      /* ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÄ‡∏ö‡∏¥‡∏Å" ‡πÉ‡∏´‡πâ‡πÄ‡∏•‡πá‡∏Å‡∏•‡∏á */
  line-height: 1.25 !important;
}

#summaryContent .form-label{
  font-size: .95rem !important;       /* ‡∏õ‡πâ‡∏≤‡∏¢‡∏Å‡∏≥‡∏Å‡∏±‡∏ö (Company, Cost Center, ...) ‡πÉ‡∏´‡πâ‡πÄ‡∏•‡πá‡∏Å‡∏•‡∏á */
  font-weight: 600 !important;
  color: #374151 !important;
}

/* ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ñ‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Company/Employee ID/Full Name/BU Admin...) */
#summaryContent .form-value{
  font-size: 1rem !important;
  font-weight: 400 !important;   /* ‚Üê ‡πÄ‡∏î‡∏¥‡∏° 800 */
  line-height: 1.45 !important;
  padding: 14px 16px !important;
  border-radius: 12px !important;
  border: 1px solid #e5e7eb !important;
  background: #fff !important;
  box-shadow: inset 0 0 0 1px #eef2f7 !important;
}

/* ‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ä‡πà‡∏≠‡∏á‡πÉ‡∏ô‡∏Å‡∏£‡∏¥‡∏î */
#summaryContent .form-grid{ gap: 14px !important; }
#summaryContent .form-field{ gap: 6px !important; }

/* ‡∏à‡∏∏‡∏î‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏•‡πá‡∏Å‡∏•‡∏á‡∏ô‡∏¥‡∏î‡∏ô‡∏∂‡∏á */
#summaryContent .dot{ width: .55rem !important; height: .55rem !important; }
    

    /* ===== THANK YOU (‡πÅ‡∏ö‡∏ö‡∏£‡∏π‡∏õ‡πÅ‡∏£‡∏Å) ===== */
.thx-wrap{max-width:420px;margin:0 auto;padding:24px 16px 34px;}
.thx-card{background:#fff;border-radius:20px;box-shadow:0 20px 40px rgba(0,0,0,.12);padding:24px 18px;position:relative;}
.thx-logo{position:absolute;top:14px;right:14px;height:32px;width:auto;background:#fff;border-radius:10px;padding:4px 6px;box-shadow:0 3px 8px rgba(0,0,0,.12);}
.thx-check{width:72px;height:72px;border-radius:9999px;display:flex;align-items:center;justify-content:center;margin:6px auto 14px;background:#22c55e;color:#fff;box-shadow:0 10px 24px rgba(34,197,94,.35);}
.thx-title{text-align:center;font-weight:900;font-size:1.55rem;color:#0f172a;}
.thx-sub{text-align:center;margin-top:6px;color:#6b7280;font-weight:600;font-size:.95rem;}
.thx-detail{margin-top:16px;background:#eef2ff;border:1px solid #e5e7eb;border-radius:16px;padding:16px 14px;box-shadow:0 8px 18px rgba(0,0,0,.06);}
.thx-detail h4{display:flex;align-items:center;justify-content:center;gap:8px;margin-bottom:10px;font-weight:900;color:#1f2937;}
.thx-grid{display:grid;gap:10px;}
.thx-row{display:flex;justify-content:space-between;background:#fff;border-radius:12px;padding:10px 12px;}
.thx-label{color:#6b7280;font-weight:700;}
.thx-value{color:#111827;font-weight:800;}
.thx-ref{color:#2563eb;font-weight:900;}
.thx-total{color:#10b981;font-weight:900;}
.thx-btn{margin-top:18px;width:100%;min-height:48px;border-radius:12px;font-weight:900;color:#fff;background:linear-gradient(135deg,#6366f1,#8b5cf6);display:flex;align-items:center;justify-content:center;gap:8px;box-shadow:0 8px 18px rgba(99,102,241,.25);}
.thx-footer{margin-top:16px;text-align:center;color:#6b7280;font-weight:600;font-size:.9rem;}
.thx-footer .row{display:flex;gap:16px;justify-content:center;margin-top:6px;color:#334155;font-weight:800;}
body.thankyou .content-card{background:transparent;box-shadow:none;padding:0;}
body.thankyou .page-container{align-items:flex-start;padding-top:32px;}

    /* ‡∏ã‡πà‡∏≠‡∏ô‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏°‡∏∏‡∏°‡∏Ç‡∏ß‡∏≤‡∏ö‡∏ô‡∏ï‡∏±‡∏ß global ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏´‡∏ô‡πâ‡∏≤‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì */
body.thankyou .corner-logo{ display:none !important; }

/* ‡πÉ‡∏´‡πâ‡∏´‡∏ô‡πâ‡∏≤ Thank You ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏ó‡∏±‡πâ‡∏á html ‡πÅ‡∏•‡∏∞ body */
html.thankyou,
body.thankyou {
  background:#f8fafc !important;
}
body.thankyou .page-container {
  padding: 24px 12px;                      /* ‡πÄ‡∏ß‡πâ‡∏ô‡∏Ç‡∏≠‡∏ö‡∏ö‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏ô‡∏¥‡∏î‡∏´‡∏ô‡πà‡∏≠‡∏¢ */
  align-items: flex-start;
}
body.thankyou .content-card{
  background: transparent;                 /* ‡πÇ‡∏õ‡∏£‡πà‡∏á‡πÉ‡∏™ */
  box-shadow: none;
  padding: 0;
  max-width: 480px;                        /* ‡∏Å‡∏£‡∏≠‡∏ö‡πÅ‡∏Ñ‡∏ö‡∏•‡∏á */
}

/* ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì (‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà 2) */
.ty-wrap{ max-width:440px; margin:0 auto; }
.ty-check{
  width:88px; height:88px; border-radius:9999px; margin:8px auto 16px;
  display:flex; align-items:center; justify-content:center;
  background:#22c55e; color:#fff; box-shadow:0 10px 24px rgba(34,197,94,.35);
}
.ty-title{ text-align:center; font-weight:900; font-size:1.625rem; color:#0f172a; }
.ty-sub{ text-align:center; margin-top:8px; color:#6b7280; font-weight:600; }

.ty-card{
  margin-top:16px; background:#eaf1ff; border:1px solid #e5e7eb;
  border-radius:16px; padding:18px 16px; box-shadow:0 8px 18px rgba(0,0,0,.06);
}
.ty-card h4{ display:flex; align-items:center; justify-content:center; gap:8px;
  font-weight:900; color:#1f2937; margin-bottom:10px; }

.ty-grid{ display:grid; gap:10px; }
.ty-row{ display:flex; justify-content:space-between; align-items:center;
  background:#fff; border:1px solid #e5e7eb; border-radius:12px; padding:10px 12px; }
.ty-label{ color:#6b7280; font-weight:700; }
.ty-val{ color:#0f172a; font-weight:800; }
.ty-ref{ color:#2563eb; font-weight:900; }
.ty-total{ color:#10b981; font-weight:900; }

.ty-next{
  margin-top:16px;
  background: linear-gradient(180deg,#ffffff 0%, #fff7ed 100%);
  border: none;
  border-radius:16px;
  padding:18px 16px;
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:6px;
  color:#334155;            /* ‡∏ï‡∏±‡∏ß‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ */
  font-weight:600;
  text-align:center;
}
.ty-next .emoji{            /* ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô */
  font-size:28px;
  line-height:1;
}
.ty-next .title{            /* ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏´‡∏ô‡∏≤ */
  color:#0f172a;
  font-weight:800;
}
.ty-next .desc{             /* ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ (‡∏°‡∏µ‡πÄ‡∏ß‡πâ‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î) */
  color:#6b7280;
  line-height:1.6;
}

/* ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß ‡πÇ‡∏ó‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏∑‡πà‡∏ô + ‡πÄ‡∏ß‡πâ‡∏ô‡∏´‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏Å‡∏•‡πà‡∏≠‡∏á "‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ" */
.ty-btn{
  width:100%;
  min-height:52px;
  margin-top:24px;                 /* ‚Üê ‡∏Ç‡∏¢‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏á‡∏°‡∏≤ */
  border-radius:12px;
  font-weight:900;
  color:#fff;
  background:linear-gradient(135deg,#10b981,#059669); /* emerald-500 ‚Üí 600 */
  box-shadow:0 10px 22px rgba(16,185,129,.25);
}
.ty-btn:hover{
  background:linear-gradient(135deg,#059669,#047857);
  transform:translateY(-1px);
  box-shadow:0 14px 28px rgba(16,185,129,.35);
}
    
/* ‡πÄ‡∏™‡πâ‡∏ô‡∏Ñ‡∏±‡πà‡∏ô‡∏ö‡∏≤‡∏á ‡πÜ ‡πÄ‡∏´‡∏ô‡∏∑‡∏≠‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ */
.ty-divider{
  height:1px;
  background:#e5e7eb;  /* ‡πÄ‡∏ó‡∏≤‡∏≠‡πà‡∏≠‡∏ô */
  margin:20px 0 12px;  /* ‡πÄ‡∏ß‡πâ‡∏ô‡∏ö‡∏ô-‡∏•‡πà‡∏≤‡∏á‡∏ï‡∏≤‡∏°‡∏†‡∏≤‡∏û‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á */
  border:0;
  border-radius:1px;
}

/* ‡∏Ç‡∏¢‡∏±‡∏ö‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î "‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°" ‡∏•‡∏á‡∏°‡∏≤‡∏≠‡∏µ‡∏Å‡∏ô‡∏¥‡∏î */
.ty-footer{
  margin-top:8px;
  text-align:center;
  color:#6b7280;
  font-weight:600;
  font-size:.9rem;
}
.ty-footer .row{
  margin-top:6px;
  display:flex;
  justify-content:center;
  gap:16px;
  color:#334155;
  font-weight:800;
}
/* ================== THANK YOU TYPO OVERRIDES ================== */
/* ‡πÉ‡∏ä‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏´‡∏ô‡πâ‡∏≤ Thank You ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô */
body.thankyou .ty-title{
  /* ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÉ‡∏´‡∏ç‡πà: ‡πÉ‡∏´‡πâ '‡∏´‡∏ô‡∏≤' ‡πÅ‡∏ï‡πà‡∏•‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡∏ô‡∏¥‡∏î‡∏´‡∏ô‡πà‡∏≠‡∏¢‡πÉ‡∏´‡πâ‡∏û‡∏≠‡∏î‡∏µ‡∏™‡∏≤‡∏¢‡∏ï‡∏≤ */
  font-weight:700 !important;     /* ‡πÄ‡∏î‡∏¥‡∏° 900 */
  font-size:1.5rem !important;    /* ‡πÄ‡∏î‡∏¥‡∏° 1.625rem */
  line-height:1.25 !important;
}

/* ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏¢‡πà‡∏≠‡∏¢‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πå‡∏î ‡πÅ‡∏•‡∏∞‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ "‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ" ‡πÉ‡∏´‡πâ‡∏´‡∏ô‡∏≤ ‡πÅ‡∏ï‡πà‡∏Ç‡∏ô‡∏≤‡∏î‡∏Å‡∏£‡∏∞‡∏ä‡∏±‡∏ö */
body.thankyou .ty-card h4,
body.thankyou .ty-next .title{
  font-weight:700 !important;     /* ‡πÄ‡∏î‡∏¥‡∏° 800‚Äì900 */
  font-size:1.0625rem !important; /* ‚âà 17px */
  line-height:1.35 !important;
}

/* "‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠" ‚Üí ‡πÑ‡∏°‡πà‡∏´‡∏ô‡∏≤ + ‡∏Ç‡∏ô‡∏≤‡∏î‡∏õ‡∏Å‡∏ï‡∏¥ */
body.thankyou .ty-sub,
body.thankyou .ty-card,
body.thankyou .ty-grid,
body.thankyou .ty-row,
body.thankyou .ty-label,
body.thankyou .ty-val,
body.thankyou .ty-ref,
body.thankyou .ty-total,
body.thankyou .ty-next,
body.thankyou .ty-next .desc,
body.thankyou .ty-footer,
body.thankyou .ty-footer .row,
body.thankyou .ty-btn{
  font-weight:400 !important;
  font-size:1rem !important;
  line-height:1.5 !important;
}

/* ‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÇ‡∏ó‡∏ô‡∏™‡∏µ‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á '‡πÄ‡∏•‡∏Ç‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á' ‡πÅ‡∏•‡∏∞ '‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ß‡∏°' ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏´‡∏ô‡∏≤ */
body.thankyou .ty-ref{ color:#2563eb !important; }
body.thankyou .ty-total{ color:#10b981 !important; }

/* ‡∏ü‡∏∏‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡πå: ‡∏Ñ‡∏á .9rem ‡∏ñ‡πâ‡∏≤‡∏ä‡∏≠‡∏ö‡πÉ‡∏´‡πâ‡πÄ‡∏•‡πá‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏ö‡∏≠‡∏î‡∏µ‡πâ‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ ‡∏Å‡πá‡πÄ‡∏≠‡∏≤‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏≠‡∏≠‡∏Å‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå‡πÅ‡∏ó‡∏ô */
 /* body.thankyou .ty-footer,
    body.thankyou .ty-footer .row{ font-size:.9rem !important; } */

    
   /* ===== BLOCKED ‚Äì ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏ï‡∏£‡∏á‡∏£‡∏π‡∏õ 2 ===== */
.blk-wrap{ max-width:880px; margin:0 auto; padding:32px 16px; }

.blk-card{
  position:relative;
  background:#ffffff;
  border-radius:28px;
  box-shadow:0 26px 56px rgba(0,0,0,.14);
  padding:38px 28px 28px;
  text-align:center;
}

/* ‡∏ß‡∏á‡∏Å‡∏•‡∏°‡∏™‡πâ‡∏°‡∏ó‡∏π‡πÇ‡∏ó‡∏ô‡∏•‡∏≠‡∏¢‡∏ã‡πâ‡∏≠‡∏ô‡∏Ç‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πå‡∏î */
.blk-icon{
  width:96px; height:96px; border-radius:9999px;
  margin:-62px auto 10px; /* ‡∏ã‡πâ‡∏≠‡∏ô‡∏û‡∏≠‡∏î‡∏µ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏†‡∏≤‡∏û */
  display:flex; align-items:center; justify-content:center;
  background:linear-gradient(180deg,#ffb36b 0%, #ff7a59 100%);
  box-shadow:0 14px 30px rgba(0,0,0,.18), inset 0 2px 0 rgba(255,255,255,.35);
}
.blk-icon svg{ width:46px; height:46px; color:#ffffff; }

.blk-title{ font-weight:800; font-size:2rem; color:#111827; margin-top:6px; }
.blk-sub{ color:#6b7280; font-weight:600; margin-top:6px; }

/* ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ (‡∏ü‡πâ‡∏≤-‡∏°‡πà‡∏ß‡∏á‡∏≠‡πà‡∏≠‡∏ô) */
.blk-admin{
  margin:20px auto 0;
  background:linear-gradient(180deg,#f0f5ff 0%, #eef2ff 100%);
  border:1px solid #e6e9f2;
  border-radius:18px;
  padding:18px 16px;
  max-width:560px;
}
.blk-admin-title{ color:#334155; font-weight:800; margin-bottom:6px; }
.blk-admin-name{ color:#0f172a; font-weight:400; }
.blk-admin-email{
  display:inline-flex; align-items:center; gap:6px;
  margin-top:6px; color:#2563eb; font-weight:400; text-decoration:none;
}
/* ‡∏õ‡∏∏‡πà‡∏°‡∏°‡πà‡∏ß‡∏á‡πÑ‡∏•‡πà‡πÄ‡∏â‡∏î + ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏ö‡πâ‡∏≤‡∏ô */
.blk-btn{
  width:100%;
  max-width:560px;
  margin:20px auto 0;
  display:inline-flex;
  align-items:center;
  justify-content:center;
  min-height:54px;
  border:0;
  border-radius:16px;
  color:#fff;
  font-weight:700;
  font-size:1.05rem;
  background:linear-gradient(135deg,#6d28d9,#7c3aed 45%,#8b5cf6 100%);
  box-shadow:0 14px 30px rgba(107,70,193,.28);
  transition:transform .18s, box-shadow .18s;
}
.blk-btn:hover{
  transform:translateY(-1px);
  box-shadow:0 18px 36px rgba(107,70,193,.34);
}
.blk-btn svg{ width:22px; height:22px; color:#fff; }

/* ‡∏ã‡πà‡∏≠‡∏ô‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏°‡∏∏‡∏° + ‡∏õ‡∏∏‡πà‡∏°‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤ ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏° */
body.blocked .corner-logo{ display:none !important; }
body.summary #cartFab,
body.thankyou #cartFab,
body.blocked #cartFab { display:none !important; }

/* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÑ‡∏•‡πà‡∏™‡∏µ‡πÅ‡∏ö‡∏ö‡∏£‡∏π‡∏õ 2 */
body.blocked{
  background:
    radial-gradient(1200px 480px at 15% -10%, #ffe9c4 0%, transparent 60%),
    radial-gradient(1200px 480px at 85% 120%, #ffd9ef 0%, transparent 60%),
    linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%) !important;
}

/* ‡πÄ‡∏≠‡∏≤‡∏Å‡∏£‡∏≠‡∏ö‡∏Ç‡∏≤‡∏ß global ‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏∑‡πà‡∏ô‡∏≠‡∏≠‡∏Å‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ ‡πÅ‡∏•‡∏∞‡πÉ‡∏´‡πâ‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏û‡∏≠‡∏î‡∏µ */
body.blocked .content-card{
  background: transparent !important;
  box-shadow: none !important;
  padding: 0 !important;
  max-width: 960px !important;
}
    /* === Verify Card on white background === */

.verify-box{
  position:relative;
  background:#ffffff;
  border-radius:18px;
  border:1px solid rgba(15,23,42,.06);
  box-shadow:0 20px 42px rgba(2,8,23,.12);
  padding:70px 40px;
  text-align:center;
  width:100%;
  max-width:580px;
  margin:auto;
}
@media (max-width: 480px){
  .verify-box{
    padding:40px 24px;
    max-width:90vw;
  }
}

.verify-box::after{ content:none; }

.verify-icon{
  width:85px; 
  height:85px; 
  margin:-40px auto 36px;
  border-radius:9999px; 
  background:#10b981; 
  color:#fff;
  display:flex; 
  align-items:center; 
  justify-content:center;
  font-size:44px; 
  box-shadow:0 6px 16px rgba(16,185,129,.25);
}
    
    .verify-icon{
  width:85px;
  height:85px;
  margin:-55px auto 28px;
  border-radius:9999px;
  background:#10b981;
  display:flex;
  align-items:center;
  justify-content:center;
  box-shadow:0 8px 20px rgba(16,185,129,.28);
}

.icon-img{
  width:60px;            /* ‚¨ÜÔ∏è ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏†‡∏≤‡∏û */
  height:55px;
  filter: brightness(0) invert(1); /* ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏≠‡∏¥‡πÇ‡∏°‡∏à‡∏¥‡πÄ‡∏î‡∏¥‡∏° */
}

.icon-credit{
  font-size:0.75rem;
  text-align:center;
  color:#94a3b8;
  margin-top:8px;
}

.icon-credit a{
  color:#047857;
  text-decoration:none;
}

.icon-credit a:hover{
  text-decoration:underline;
}

.verify-title{
  font-weight:900;
  font-size:1.75rem;
  letter-spacing:.02em;
  text-transform:uppercase;
  color:#0f172a;
  margin-bottom:.5rem;           /* ‡πÄ‡∏ß‡πâ‡∏ô‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÉ‡∏´‡∏ç‡πà‡∏Å‡∏±‡∏ö‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏£‡∏≠‡∏á */
}
.verify-subtitle{
  font-size:1.125rem;
  color:#334155;
  font-weight:700;
  margin:.25rem 0 .875rem;       /* ‡πÄ‡∏ß‡πâ‡∏ô‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÉ‡∏´‡πâ‡πÉ‡∏Å‡∏•‡πâ‡∏†‡∏≤‡∏û‡πÅ‡∏£‡∏Å */
}
.verify-desc{
  font-size:.95rem;
  color:#64748b;
  text-align:left;
  margin: .5rem 0 .35rem;   /* ‡∏•‡∏î‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏ö‡∏ô/‡∏•‡πà‡∏≤‡∏á */
}

.verify-input{
  width:100%;
  padding:12px 14px 12px 48px;
  text-align:left;
  background:#fff;
  border:1.5px solid #cbd5e1;
  border-radius:10px;
  font-size:1rem;
  color:#0f172a;
  transition: all .2s ease-in-out;
  margin-top:.5rem;          /* ‡∏à‡∏≤‡∏Å 16px ‚Üí ~8px */
}
    
    /* === icon-in-input (‡∏ã‡πâ‡∏≤‡∏¢) === */
.input-wrapper{
  position:relative;
  width:100%;
}
.input-icon{
  position:absolute;
  left:14px;
  top:60%;
  transform:translateY(-50%);
  width:24px;
  height:24px;
  opacity:.9;
  pointer-events:none; /* ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏£‡∏ö‡∏Å‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏•‡∏¥‡∏Å‡πÉ‡∏ô input */
}
    
.verify-input::placeholder{
  font-size:.95rem;         /* ‚Üë */
  color:#94a3b8;
}
    
.verify-input:focus{
  outline:none;
  border-color:#10b981;
  box-shadow:0 0 0 3px rgba(16,185,129,.18);
}

/* ‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡∏á‡πÇ‡∏ó‡∏ô‡πÄ‡∏î‡∏¥‡∏° */
.verify-action{
  width:100%;
  min-height:56px;                  /* ‚Üë ‡∏™‡∏π‡∏á‡∏Ç‡∏∂‡πâ‡∏ô */
  padding:14px 18px;                /* ‚Üë */
  border-radius:14px;
  font-weight:900;
  font-size:1.05rem;                /* ‚Üë ‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ */
  color:#fff;
  background:linear-gradient(135deg,#10b981,#059669);
  box-shadow:0 12px 26px rgba(16,185,129,.28);
}
.verify-action:hover{
  background:linear-gradient(135deg,#059669,#047857);
  transform:translateY(-1px);
}
    .verify-button {
  width: 100%;
  background: linear-gradient(to right, #10b981, #059669);
  color: #fff;
  font-weight: 600;
  border: none;
  border-radius: 12px;
  padding: 12px;
  cursor: pointer;
  transition: all .2s ease-in-out;
  /* ‡∏Ç‡∏¢‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏á‡πÉ‡∏´‡πâ‡πÇ‡∏õ‡∏£‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô */
  margin-top: 2rem; /* ‚âà 28px */
}
    
  </style>
</head>

<body>
  <div class="appbar">
    <div class="appbar-inner">
  <div class="appbar-logo">
    <img
  src="https://i.postimg.cc/B6wpk3yh/cropped-Logo-BJC-Big-C-2021-2048x606.png"
  alt="BJC Big C"
  class="appbar-logo-img"
  decoding="async"
  loading="lazy"
  onerror="this.onerror=null;this.src='https://via.placeholder.com/120x30?text=%20';"
/>
  </div>
  <div class="appbar-title sr-only">BJC Big C Stationery Store</div>
</div>
  </div>

  <div class="page-container centered" id="pageContainer">
    <div class="content-card text-center" id="mainCard">
      <!-- ‡πÉ‡∏ä‡πâ‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏ö‡∏ô App Bar ‡πÅ‡∏•‡πâ‡∏ß ‡∏à‡∏∂‡∏á‡∏ã‡πà‡∏≠‡∏ô‡∏ï‡∏±‡∏ß‡∏ô‡∏µ‡πâ -->
<!-- <img ... class="corner-logo ..."> -->

      <!-- Cart Floating Button -->
      <button id="cartFab" class="cart-btn" onclick="openCart()" aria-label="‡πÄ‡∏õ‡∏¥‡∏î‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤">
        <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M3 3h2l.4 2M7 13h9l3-8H6.4M7 13L5.4 5M7 13l-2 6h13M10 21a1 1 0 110-2 1 1 0 010 2zm7 0a1 1 0 110-2 1 1 0 010 2z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <span id="cartBadge" class="cart-badge" style="display:none">0</span>
      </button>

       <div id="verifyContent" class="hidden flex justify-center items-center min-h-[80vh]">
  <div class="verify-box">
    <div class="verify-icon">
  <img src="https://i.postimg.cc/CKkxKHBg/office.png" alt="Office Icon" class="icon-img">
</div>

    <h1 class="verify-title">BJC Big C STATIONERY STORE</h1>
<p class="verify-subtitle">‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ö‡∏¥‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</p>

<!-- ‡∏¢‡πâ‡∏≤‡∏¢‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏•‡πá‡∏Å‡πÉ‡∏´‡πâ‡∏ä‡∏¥‡∏î‡∏ã‡πâ‡∏≤‡∏¢ -->
<p class="verify-desc text-left">‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</p>

    <!-- ‡∏Ñ‡∏á id ‡πÄ‡∏î‡∏¥‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå -->
    <label for="employeeId" class="sr-only">‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</label>

<div class="input-wrapper">
  <img src="https://i.postimg.cc/4NKdMhvp/id-card.png" alt="badge" class="input-icon" />
  <input id="employeeId" type="text" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô" class="verify-input" />
</div>

    <div id="message" class="hidden mt-4 p-4 rounded-lg text-center"></div>

    <button id="verifyBtn"
        class="verify-button"
        onclick="verifyEmployee()">
  ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô
</button>
  </div>
</div>
      
      <!-- ============ Categories ============ -->
      <div id="categoryContent" class="hidden text-left">
        <div class="green-shell">
          <div class="category-inner">
            <div class="hero">
              <div class="logo-box">
                <img src="https://i.postimg.cc/B6wpk3yh/cropped-Logo-BJC-Big-C-2021-2048x606.png" alt="BJC Big C" onerror="this.style.display='none'"/>
              </div>
              <h1 class="hero-title">BJC Big C</h1>
              <div class="hero-sub">STATIONERY&nbsp;STORE</div>
              <div class="hero-dots"><span></span><span class="dim"></span><span class="dim"></span></div>
              <p class="hero-desc">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡∏¥‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏ó‡πà‡∏≤‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å</p>
            </div>

            <div class="panel">
              <div class="panel-head">
                <h3 class="text-2xl md:text-3xl font-extrabold text-emerald-900">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</h3>
                <p class="text-gray-600 mt-1">‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å</p>
              </div>
              <div class="panel-body">
                <div id="categoryGrid" class="grid grid-cols-1 md:grid-cols-2 gap-6"></div>
              </div>

              <button class="back-btn" onclick="backToVerifyProceed()">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"/></svg>
                ‡∏Å‡∏•‡∏±‡∏ö
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- ============ Products (‡πÉ‡∏´‡∏°‡πà) ============ -->
      <div id="productsContent" class="hidden text-left">
        <div class="green-shell">
          <div class="products-inner">
            <div class="hero">
              <div class="logo-box">
                <img src="https://i.postimg.cc/B6wpk3yh/cropped-Logo-BJC-Big-C-2021-2048x606.png" alt="BJC Big C" onerror="this.style.display='none'"/>
              </div>
              <h1 class="hero-title" id="prodHeroTitle">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h1>
              <div class="hero-sub">STATIONERY&nbsp;STORE</div>
              <div class="hero-dots"><span class="dim"></span><span></span><span class="dim"></span></div>
              <p class="hero-desc" id="prodHeroDesc">‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</p>
            </div>

            <div class="panel">
              <div class="panel-head">
                <h3 class="text-2xl md:text-3xl font-extrabold text-emerald-900" id="prodTitle">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h3>
                <p class="text-gray-600 mt-1">‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</p>
              </div>
              <div class="panel-body">
                <div id="productGrid" class="grid grid-cols-1 md:grid-cols-3 gap-5"></div>
              </div>

              <button class="back-btn" onclick="backToCategories()">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"/></svg>
                ‡∏Å‡∏•‡∏±‡∏ö
              </button>
            </div>
          </div>
        </div>
      </div>
<!-- ============ Summary (‡πÉ‡∏´‡∏°‡πà) ============ -->
  <div id="summaryContent" class="hidden text-left">
    <div class="green-shell">
      <div class="products-inner">
        <div class="hero">
          <div class="logo-box">
            <img src="https://i.postimg.cc/B6wpk3yh/cropped-Logo-BJC-Big-C-2021-2048x606.png" alt="BJC Big C" onerror="this.style.display='none'"/>
          </div>
          <h1 class="hero-title">‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</h1>
          <div class="hero-sub">PLEASE REVIEW AND COMPLETE THE INFORMATION</div>
          <div class="hero-dots"><span class="dim"></span><span class="dim"></span><span></span></div>
          <p class="hero-desc">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô</p>
        </div>

        <div class="panel">
          <div class="panel-head">
            <div class="flex items-start justify-between gap-4">
              <div>
                <h3 class="text-2xl md:text-3xl font-extrabold text-emerald-900">‡πÉ‡∏ö‡πÄ‡∏ö‡∏¥‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</h3>
                <p class="text-gray-600">BJC Big C Stationery Request Form</p>
              </div>
              <div class="text-right shrink-0">
                <div id="sumDate" class="text-sm text-gray-500"></div>
                <div id="sumTime" class="text-xs text-gray-400"></div>
              </div>
            </div>
          </div>

          <div class="panel-body">

           <!-- ‡∏ú‡∏π‡πâ‡πÄ‡∏ö‡∏¥‡∏Å -->
<div class="mb-6">
  <div class="flex items-center mb-4">
    <span class="dot"></span>
    <h4 class="text-xl md:text-2xl font-extrabold text-emerald-900">
      ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÄ‡∏ö‡∏¥‡∏Å / Employee Information
    </h4>
  </div>

  <!-- ‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà 1: Company / Cost Center -->
  <div class="form-grid mb-4">
    <div class="form-field">
      <label class="form-label">Company</label>
      <div id="s_company" class="form-value">-</div>
    </div>
    <div class="form-field">
      <label class="form-label">Cost Center *</label>
      <div id="s_cost" class="form-value">-</div>
    </div>
  </div>

  <!-- ‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà 2: Employee ID / Full Name -->
  <div class="form-grid">
    <div class="form-field">
      <label class="form-label">Employee ID *</label>
      <div id="s_empid" class="form-value">-</div>
    </div>
    <div class="form-field">
      <label class="form-label">Full Name *</label>
      <div id="s_fullname" class="form-value">-</div>
    </div>
  </div>
</div>

<!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• BU Admin -->
<div class="mb-6">
  <div class="flex items-center mb-4">
    <span class="dot"></span>
    <h4 class="text-xl md:text-2xl font-extrabold text-emerald-900">
      ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• BU Admin
    </h4>
  </div>

  <div class="form-grid">
    <div class="form-field">
      <label class="form-label">BU Admin Name</label>
      <div id="s_bu_name" class="form-value">‚Äî</div>
    </div>
    <div class="form-field">
      <label class="form-label">BU Admin Email *</label>
      <div id="s_bu_email" class="form-value">‚Äî</div>
    </div>
  </div>
</div>

            <!-- ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ -->
            <div class="mb-6">
              <div class="flex items-center mb-3">
                <span class="dot"></span>
                <h4 class="text-xl md:text-2xl font-extrabold text-emerald-900">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏ö‡∏¥‡∏Å / Items Requested</h4>
              </div>

              <div id="sumItems" class="mt-3"></div>

              <div class="mt-4 flex items-baseline justify-end gap-3">
  <div class="text-gray-600 font-semibold">‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:</div>
  <div id="sumTotal" class="text-emerald-600 text-xl font-extrabold">‡∏ø0</div>
</div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-6">
              <button class="py-3 rounded-xl bg-gray-700 hover:bg-gray-800 text-white font-bold" onclick="showPage('products')">‚Üê ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</button>
              <button class="py-3 rounded-xl bg-emerald-700 hover:bg-emerald-800 text-white font-extrabold" onclick="submitRequest()">‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏ö‡∏¥‡∏Å</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

 <!-- ============ Thank You (Template ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏∑‡πà‡∏ô) ============ -->
<div id="thankyouContent" class="hidden text-left">
  <div class="ty-wrap">
    <!-- ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏ï‡∏¥‡πä‡∏Å -->
    <div class="ty-check">
      <svg viewBox="0 0 24 24" width="40" height="40" fill="none">
        <circle cx="12" cy="12" r="11" stroke="white" stroke-width="2"></circle>
        <path d="M7 12.5l3 3 7-7" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"></path>
      </svg>
    </div>

    <h1 class="ty-title">üéâ Thank You!</h1>
    <div class="ty-sub">‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß</div>

    <!-- ‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î -->
    <div class="ty-card">
      <h4>üìã ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å</h4>
      <div class="ty-grid">
        <div class="ty-row">
          <div class="ty-label">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏≥‡∏Ç‡∏≠:</div>
          <div id="tyRef" class="ty-ref">#REQ-2024-001234</div>
        </div>
        <div class="ty-row">
          <div class="ty-label">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ö‡∏¥‡∏Å:</div>
          <div id="tyDate" class="ty-val">15 ‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏° 2567</div>
        </div>
        <div class="ty-row">
          <div class="ty-label">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£:</div>
          <div id="tyQty" class="ty-val">5 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div>
        </div>
        <div class="ty-row">
          <div class="ty-label">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:</div>
          <div id="tyTotal" class="ty-total">‡∏ø2,450.00</div>
        </div>
      </div>
    </div>

    <!-- ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ -->
    <div class="ty-next">
  <div class="emoji">‚è∞</div>
  <div class="title">‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</div>
  <div class="desc">
    ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏ñ‡∏±‡∏î‡πÑ‡∏õ<br>
    ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå
  </div>
</div>

    <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏•‡∏±‡∏ö -->
    <button class="ty-btn" onclick="goHomeFromThanks()"> ‡∏Å‡∏•‡∏±‡∏ö‡∏™‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
    
    <div class="ty-divider"></div>  <!-- ‚Üê ‡πÄ‡∏™‡πâ‡∏ô‡∏Ñ‡∏±‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà -->

    <!-- Footer ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ -->
    <div class="ty-footer">
      ‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠
      <div class="row">
        <span>üìû 02-123-4567</span>
        <span>‚úâÔ∏è supply@company.com</span>
      </div>
    </div>
  </div>
</div>

      <!-- ============ Blocked (‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠) ============ -->
<div id="blockedContent" class="hidden text-left">
  <div class="blk-wrap">
    <div class="blk-card">
      <!-- ‡∏ß‡∏á‡∏Å‡∏•‡∏°‡∏™‡πâ‡∏° + ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß -->
      <div class="blk-icon" aria-hidden="true">
        <svg viewBox="0 0 24 24" fill="none">
          <path d="M12 7v6" stroke="white" stroke-width="2.6" stroke-linecap="round"/>
          <circle cx="12" cy="16.5" r="1.3" fill="white"/>
        </svg>
      </div>

      <h1 class="blk-title">‚ö†Ô∏è ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠</h1>
      <div class="blk-sub">Budget BU ‡∏Ç‡∏≠‡∏á‡∏ó‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ô‡∏µ‡πâ</div>

      <!-- ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ BU Admin -->
      <div class="blk-admin">
  <div class="blk-admin-title">‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ BU Admin</div>
  <div class="blk-admin-name">üë®‚Äçüíº <span id="blkName">‚Äî</span></div>
  <a id="blkEmail" href="#" class="blk-admin-email" rel="nofollow noopener">
    <span id="blkEmailText">üìß Email BU Admin: ‚Äî</span>
  </a>
</div>

      <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å -->
<button class="blk-btn" onclick="goHomeFromBlocked()">
  ‡∏Å‡∏•‡∏±‡∏ö‡∏™‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
</button>
    </div>
  </div>
</div>

      
 </div> <!-- /content-card -->
  </div> <!-- /page-container -->


  <!-- Loading Modal -->
  <div id="checkingModal" class="hidden fixed inset-0 z-[9999] items-center justify-center bg-black/40">
    <div class="bg-white rounded-2xl shadow-2xl px-6 py-5 flex items-center gap-3">
      <svg class="w-6 h-6 animate-spin text-emerald-600" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"></path>
      </svg>
      <span class="text-gray-800 font-medium">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‚Ä¶</span>
    </div>
  </div>

  <!-- Loading Products Modal -->
  <div id="loadingProductsModal" class="hidden fixed inset-0 z-[9998] items-center justify-center bg-black/40">
    <div class="bg-white rounded-2xl shadow-2xl px-6 py-5 flex items-center gap-3">
      <svg class="w-6 h-6 animate-spin text-emerald-600" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"></path>
      </svg>
      <span class="text-gray-800 font-medium">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‚Ä¶</span>
    </div>
  </div>

  <!-- Submitting Modal -->
<div id="submittingModal" class="hidden fixed inset-0 z-[9999] items-center justify-center bg-black/40">
  <div class="bg-white rounded-2xl shadow-2xl px-6 py-5 flex items-center gap-3">
    <svg class="w-6 h-6 animate-spin text-emerald-600" viewBox="0 0 24 24" fill="none" aria-hidden="true">
      <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
      <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"></path>
    </svg>
    <span class="text-gray-800 font-medium">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏ö‡∏¥‡∏Å‚Ä¶</span>
  </div>
</div>

  <!-- Product Detail Modal -->
  <div id="itemModal" class="modal-mask">
    <div class="modal">
      <div class="flex justify-center mb-3">
        <img id="mImg" class="w-36 h-36 object-contain" src="" alt=""
     onerror="this.src='https://via.placeholder.com/144?text=%20'"/>
      </div>
      <h3 id="mName" class="text-xl font-extrabold text-center text-gray-900"></h3>
      <p id="mDetail" class="text-sm text-center text-gray-600 mt-1"></p>
      <div class="text-center text-emerald-600 text-2xl font-extrabold my-3" id="mPrice"></div>

      <div class="text-center text-gray-700 mb-2">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</div>
      <div class="flex items-center justify-center gap-3 mb-4">
        <button class="qty-btn" onclick="chgQty(-1)">‚àí</button>
        <input id="mQty" type="number" min="0" step="1" inputmode="numeric" pattern="\d*" value="1" class="w-20 text-center border border-gray-300 rounded-lg py-2" />
        <button class="qty-btn" onclick="chgQty(1)">+</button>
      </div>

      <div class="text-center mb-5">
        <span class="font-semibold">Price:</span>
        <span class="price-green" id="mTotal">‡∏ø0</span>
      </div>

      <div class="grid grid-cols-2 gap-3">
        <button class="py-3 rounded-xl bg-gray-600 text-white font-bold" onclick="closeItemModal()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
        <button class="py-3 rounded-xl bg-emerald-600 hover:bg-emerald-700 text-white font-bold" onclick="confirmAdd()">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</button>
      </div>
    </div>
  </div>

  <script>
    /* ============ CONFIG ============ */
    const container = document.getElementById('pageContainer');
    const API_BASE = 'https://script.google.com/macros/s/AKfycbzMk3CWXyFN8VQUpLdNKHG5z5IUoKYTZO7XDCGFTj-oE-EC3m2sb156xlEAmFLEi0swyQ/exec';

   /* ============ STATE ============ */
let stage = 'verify';
let currentCompany = null;
let CATEGORIES = [];
let PRODUCTS = [];
let selectedCategory = '';
let modalItem = { name:'', price:0, detail:'', image:'' };
let LAST_SUBMIT = null;

/* ===== CART STATE ===== */
let CART = [];
let CURRENT_EMP = null;
let CURRENT_BU_ADMIN = { names: [], emails: [] };

    /* ===== NEW: Budget & Admin from Emp HO (K, L, M) ===== */
let CURRENT_BUDGET = null;  // ‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå K (null/0/‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç)
let CURRENT_ADMIN_CONTACT = { name: '‚Äî', email: '‚Äî' };

async function getBudgetAndAdmin(employeeId){
  try{
    const url = `${API_BASE}?action=getBudgetAndAdmin&employeeId=${encodeURIComponent(employeeId)}`;
    const res = await fetch(url, { method:'GET', cache:'no-store' });
    if(!res.ok) return null;
    const data = await res.json().catch(()=>null);
    // ‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á { success:true, data:{ budget:number|null, adminName:string, adminEmail:string } }
    return (data && data.success) ? (data.data || null) : null;
  }catch(_){ return null; }
}

/* ‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏î‡∏£‡∏≠‡∏ö‡πÉ‡∏´‡∏°‡πà + ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å request ‡∏Ñ‡πâ‡∏≤‡∏á */
let FORCE_FRESH = false;
let inflight = { categories: null, items: null };

    function cartCount(){ return CART.reduce((s,it)=>s + (Number(it.qty)||0), 0); }
    function cartSum(){ return CART.reduce((s,it)=>s + (Number(it.qty)||0)*(Number(it.price)||0), 0); }
    function findItemKey(p){ return (p.name || '').trim().toLowerCase(); }

    function addToCart(p, qty){
      const key = findItemKey(p);
      const q = Math.max(0, Number(qty)||0);
      if(q===0) return;
      const i = CART.findIndex(it => it.key===key);
      if(i>-1){
        CART[i].qty += q;
      }else{
        CART.push({
          key,
          name: p.name || '-',
          price: Number(p.price) || 0,
          qty: q,
          image: p.image || '',
          detail: p.detail || '' // ‚úÖ ‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î (‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå I)
        });
      }
      updateCartUI();
    }

    function removeFromCart(key){
      CART = CART.filter(it => it.key!==key);
      updateCartUI();
    }

    function updateCartUI(){
      const n = cartCount();
      const badge = document.getElementById('cartBadge');
      const badgeHdr = document.getElementById('cartBadgeHdr');
      const sumEl = document.getElementById('cartSum');
      const fab = document.getElementById('cartFab');

      const isAllowedPage = document.body.classList.contains('category') || document.body.classList.contains('products');
      if (fab) { fab.classList.toggle('show', n > 0 && isAllowedPage); }

      if(badge){ badge.style.display = n>0 ? 'flex' : 'none'; badge.textContent = n; }
      if(badgeHdr){ badgeHdr.textContent = n; }
      if(sumEl){ sumEl.textContent = baht(cartSum()); }
      renderCartItems();
    }

    function renderCartItems(){
      const wrap = document.getElementById('cartItems');
      if(!wrap) return;

      if(CART.length===0){
        wrap.innerHTML = `<div class="text-center text-gray-500 py-10">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div>`;
        return;
      }

      wrap.innerHTML = CART.map(it=>{
        const line = baht((Number(it.price)||0) * (Number(it.qty)||0)); // ‡∏£‡∏ß‡∏°
        const unit = baht(Number(it.price)||0); // ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢
        const img = (it.image || '').replace(/"/g,'&quot;');
        const name = (it.name || '').replace(/</g,'&lt;').replace(/>/g,'&gt;');
        const desc = (it.detail|| '').replace(/</g,'&lt;').replace(/>/g,'&gt;');

        return `
          <div class="cart-item">
            <!-- ‡∏ã‡πâ‡∏≤‡∏¢: ‡∏†‡∏≤‡∏û + ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -->
            <div class="left">
              <img src="${img}" class="thumb" onerror="this.src='https://via.placeholder.com/40?text=%20'" alt="">
              <div class="info">
                <div class="name">${name}</div>
                ${desc ? `<span class="desc">${desc}</span>` : ``}
                <div class="meta">${unit} √ó ${it.qty}</div>
              </div>
            </div>
            <!-- ‡∏Ç‡∏ß‡∏≤: ‡∏£‡∏≤‡∏Ñ‡∏≤(‡∏£‡∏ß‡∏°) ‡∏ö‡∏ô + ‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏ö ‡∏•‡πà‡∏≤‡∏á -->
            <div class="right">
              <div class="line">${line}</div>
              <button class="remove"
  onclick="removeFromCart('${(it.key||"").replace(/'/g,"\\'")}')"
  aria-label="‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ">‡∏•‡∏ö</button>
            </div>
          </div>
        `;
      }).join('');
    }

    function openCart(){
      document.getElementById('cartMask')?.classList.add('show');
      renderCartItems();
    }
    function closeCart(){
      document.getElementById('cartMask')?.classList.remove('show');
    }
    function proceedCart(){
      closeCart();
      showPage('summary'); // ‚úÖ ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà
      renderSummary();     // ‚úÖ ‡πÄ‡∏ï‡∏¥‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏£‡∏∏‡∏õ
    }

    /* ============ Utilities ============ */
    const baht = n => '‡∏ø' + Number(n || 0).toLocaleString('th-TH', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
    function normalizeCompanyName(s=''){
      const t = String(s).toLowerCase();
      if (t.includes('big c') || t.includes('bigc')) return 'Big C';
      return 'BJC';
    }

    /* ====== Categories ====== */
    async function getCategories(company, limit = 50){
  // ‚úÖ ‡∏™‡πà‡∏á debug=1 ‡πÄ‡∏û‡∏∑‡πà‡∏≠ bypass cache ‡∏Ç‡∏≠‡∏á Apps Script ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏£‡∏≠‡∏ö‡πÉ‡∏´‡∏°‡πà
  const params = new URLSearchParams({
    action: 'getCategories',
    company: company || 'BJC',
    limit: Math.min(Math.max(parseInt(limit) || 50, 1), 50),
    debug: FORCE_FRESH ? '1' : '0'
  });

  inflight.categories?.abort();
  inflight.categories = new AbortController();

  const res = await fetch(`${API_BASE}?${params.toString()}`, {
    method: 'GET',
    cache: 'no-store',
    signal: inflight.categories.signal
  }).catch(() => null);

  if (!res || !res.ok) return [];
  const data = await res.json().catch(()=>null);
  return (data && data.success && Array.isArray(data.data)) ? data.data : [];
}

    function renderCategories(){
      const grid = document.getElementById('categoryGrid');
      if(!grid) return;

      if(!CATEGORIES || CATEGORIES.length === 0){
        grid.innerHTML = `<div class="col-span-2 text-center text-gray-500 py-6">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‚Ä¶</div>`;
        return;
      }

      grid.innerHTML = CATEGORIES.map(c => `
        <button class="cat-item" onclick="openCategory('${(c.title||'').replace(/'/g, "\\'")}')">
          <div class="font-bold text-lg text-gray-900">${c.title}</div>
          <div class="text-emerald-700 font-extrabold mt-1">${c.count ?? 0} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div>
        </button>
      `).join('');
    }

    let OPENING = false;
async function openCategory(name){
  if (OPENING) return;
  OPENING = true;
  selectedCategory = name;
  showLoadingProductsModal(true);
  try{
    await goProductsPage();
  }finally{
    showLoadingProductsModal(false);
    OPENING = false;
  }
}

    function showSubmittingModal(show=true){
  const m = document.getElementById('submittingModal');
  if(!m) return;
  if(show){ m.classList.remove('hidden'); m.classList.add('flex'); }
  else { m.classList.add('hidden'); m.classList.remove('flex'); }
}

    async function preloadCategoriesFor(company){
      currentCompany = normalizeCompanyName(company);
      CATEGORIES = await getCategories(currentCompany, 50);
      renderCategories();
      updateCartUI();
    }

    /* ====== Products ====== */
   async function getItems(company, category, limit=100){
  const params = new URLSearchParams({
    action: 'getItems',
    company,
    category,
    limit,
    debug: FORCE_FRESH ? '1' : '0'
  });

  // ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏Å‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡∏Ñ‡πâ‡∏≤‡∏á
  inflight.items?.abort();

  const ctrl = new AbortController();
  inflight.items = ctrl;

  // ‚è±Ô∏è timeout ‡∏Å‡∏±‡∏ô‡∏Ñ‡πâ‡∏≤‡∏á (15s)
  const timer = setTimeout(() => {
    try { ctrl.abort('timeout'); } catch(_) {}
  }, 15000);

  try{
    const res = await fetch(`${API_BASE}?${params.toString()}`, {
      method:'GET',
      cache:'no-store',
      signal: ctrl.signal
    });

    if(!res.ok) return [];
    const data = await res.json().catch(()=>null);
    return (data && data.success && Array.isArray(data.items)) ? data.items : [];
  } catch(_){
    // ‡∏ñ‡πâ‡∏≤‡∏Ñ‡πâ‡∏≤‡∏á/‡∏´‡∏•‡∏∏‡∏î ‡πÉ‡∏´‡πâ‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏¥‡∏™‡∏ï‡πå‡∏ß‡πà‡∏≤‡∏á ‡πÅ‡∏ï‡πà‡∏≠‡∏¢‡πà‡∏≤‡πÉ‡∏´‡πâ UI ‡∏Ñ‡πâ‡∏≤‡∏á
    return [];
  } finally{
    clearTimeout(timer);
  }
}

    async function goProductsPage(){
  const grid = document.getElementById('productGrid');
  PRODUCTS = [];
  if (grid) grid.innerHTML = `<div class="col-span-2 text-center text-gray-500 py-6">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‚Ä¶</div>`;

  const items = await getItems(currentCompany || 'BJC', selectedCategory, 200);
  PRODUCTS = items;

  // ‚úÖ ‡∏´‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à ‚Üí ‡∏õ‡∏¥‡∏î‡πÇ‡∏´‡∏°‡∏î‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏î (‡πÄ‡∏´‡∏•‡∏∑‡∏≠ cache ‡∏£‡∏≠‡∏ö‡∏ñ‡∏±‡∏î‡πÑ‡∏õ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢)
  FORCE_FRESH = false;

  document.getElementById('prodTitle').textContent = '‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤';
  document.getElementById('prodHeroTitle').textContent = selectedCategory;
  document.getElementById('prodHeroDesc').textContent = '‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô';

  renderProducts();
  showPage('products');
}

    function renderProducts(){
  const grid = document.getElementById('productGrid');
  if(!grid){ showLoadingProductsModal(false); return; }

  if(!PRODUCTS || PRODUCTS.length === 0){
    grid.innerHTML = `<div class="col-span-2 text-center text-gray-500 py-6">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏´‡∏°‡∏ß‡∏î‡∏ô‡∏µ‡πâ</div>`;
    showLoadingProductsModal(false);
    return;
  }

  grid.innerHTML = PRODUCTS.map((p,idx) => `
    <button class="prod-card" onclick="openItem(${idx})">
      <img class="prod-img" src="${p.image || ''}" onerror="this.src='https://via.placeholder.com/112?text=%20'" alt="">
      <div class="font-bold text-gray-900 leading-snug">${p.name || '-'}</div>
      <div class="text-emerald-600 font-extrabold mt-1">${baht(p.price)}</div>
    </button>
  `).join('');

  // ‚úÖ ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏Ñ‡πà‡∏≤ fetch ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏ï‡πà overlay ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏õ‡∏¥‡∏î
  showLoadingProductsModal(false);
}
    // ‚õëÔ∏è Failsafe: ‡∏ñ‡πâ‡∏≤ overlay ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡πâ‡∏≤‡∏á‡πÄ‡∏Å‡∏¥‡∏ô 20s ‡πÉ‡∏´‡πâ‡∏õ‡∏¥‡∏î‡πÄ‡∏≠‡∏á
(function(){
  let t = null;
  const orig = showLoadingProductsModal;
  window.showLoadingProductsModal = function(show=true){
    orig(show);
    clearTimeout(t);
    if(show){
      t = setTimeout(()=>{ try{ orig(false); }catch(_){ } }, 20000);
    }
  };
})();


    function backToCategories(){ showPage('category'); }

    /* ====== Modal ====== */
    const modalEl = document.getElementById('itemModal');
    const mImg = document.getElementById('mImg');
    const mName = document.getElementById('mName');
    const mDetail = document.getElementById('mDetail');
    const mPrice = document.getElementById('mPrice');
    const mQty = document.getElementById('mQty');
    const mTotal = document.getElementById('mTotal');

    function normalizeQty(val){
      const n = parseInt(String(val).replace(/[^\d]/g,''), 10);
      return isNaN(n) ? 0 : Math.max(0, n);
    }
    function updateTotal(){
      const q = normalizeQty(mQty.value);
      mQty.value = q;
      mTotal.textContent = baht(q * (modalItem.price || 0));
    }
    if (mQty) {
  mQty.addEventListener('input', updateTotal);
}

    function openItem(idx){
      const p = PRODUCTS[idx];
      if(!p) return;
      modalItem = {...p};
      mImg.src = p.image || '';
      mName.textContent = p.name || '';
      mDetail.textContent = p.detail || '';
      mPrice.textContent = baht(p.price);
      mQty.value = 1;
      updateTotal();
      modalEl.style.display = 'flex';
    }
    function closeItemModal(){ modalEl.style.display = 'none'; }
    function chgQty(d){
      let q = normalizeQty(mQty.value);
      // ‡∏ñ‡πâ‡∏≤‡∏Å‡∏î + ‡πÉ‡∏´‡πâ‡∏ö‡∏ß‡∏Å‡∏ï‡∏≤‡∏°‡∏õ‡∏Å‡∏ï‡∏¥
      if (d > 0) { q = q + d; }
      // ‡∏ñ‡πâ‡∏≤‡∏Å‡∏î ‚àí ‡πÉ‡∏´‡πâ‡∏•‡∏î ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ 0
      else { q = Math.max(0, q + d); }
      mQty.value = q;
      updateTotal();
    }
    function confirmAdd(){
  let qty = normalizeQty(mQty.value);
  if (!Number.isFinite(qty) || qty <= 0) qty = 1;
  addToCart(modalItem, qty);
  closeItemModal();
}

    /* ====== Employee ====== */
    async function getEmployeeData(rawId){
      const url = `${API_BASE}?action=getEmployee&employeeId=${encodeURIComponent(rawId)}&debug=0`;
      const res = await fetch(url, { method:'GET', cache:'no-store' });
      if(!res.ok) return null;
      const data = await res.json().catch(()=>null);
      if (data && data.success && data.data) return data.data;
      return null;
    }

    /* ====== Layout helpers ====== */
    function setCentered(){ container.classList.remove('top'); container.classList.add('centered'); }
    function setTop(){ container.classList.remove('centered'); container.classList.add('top'); }

function showPage(which){
  // ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠ "home" ‡πÉ‡∏´‡πâ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ verify
  if (which === 'home') which = 'verify';

  const home    = document.getElementById('homeContent');
  const verify  = document.getElementById('verifyContent');
  const cate    = document.getElementById('categoryContent');
  const prod    = document.getElementById('productsContent');
  const sum     = document.getElementById('summaryContent');
  const thx     = document.getElementById('thankyouContent');
  const blocked = document.getElementById('blockedContent');

  // ‡∏ã‡πà‡∏≠‡∏ô‡∏ó‡∏∏‡∏Å‡∏´‡∏ô‡πâ‡∏≤ (‡πÄ‡∏ä‡πá‡∏Ñ null ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏ö‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏ñ‡∏π‡∏Å‡∏•‡∏ö)
  if (home)    home.classList.add('hidden');
  if (verify)  verify.classList.add('hidden');
  if (cate)    cate.classList.add('hidden');
  if (prod)    prod.classList.add('hidden');
  if (sum)     sum.classList.add('hidden');
  if (thx)     thx.classList.add('hidden');
  if (blocked) blocked.classList.add('hidden');

  document.body.classList.remove('category','products','summary','not-home','thankyou','blocked','verify');
  document.documentElement.classList.remove('thankyou');

  // ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
  if (which === 'verify'){
    if (verify) verify.classList.remove('hidden');
    document.body.classList.add('not-home','verify');
    setCentered();
    stage = 'verify';
    resetVerifyButton();

  } else if (which === 'category'){
    if (cate) cate.classList.remove('hidden');
    document.body.classList.add('not-home','category');
    setTop();
    if (!CATEGORIES || CATEGORIES.length === 0){
      preloadCategoriesFor(currentCompany || 'BJC');
    } else {
      renderCategories();
    }

  } else if (which === 'products'){
    if (prod) prod.classList.remove('hidden');
    document.body.classList.add('not-home','products');
    setTop();

  } else if (which === 'summary'){
    if (sum) sum.classList.remove('hidden');
    document.body.classList.add('not-home','summary');
    setTop();

  } else if (which === 'thankyou'){
    if (thx) thx.classList.remove('hidden');
    document.body.classList.add('not-home','thankyou');
    document.documentElement.classList.add('thankyou');
    setTop();

  } else if (which === 'blocked'){
    if (blocked) blocked.classList.remove('hidden');
    document.body.classList.add('not-home','blocked');
    setCentered();
  }

  // ‡∏Å‡∏±‡∏ô overlay ‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡πâ‡∏≤‡∏á
  showLoadingProductsModal(false);

  // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï scroll + ‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏•‡∏≠‡∏¢‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡πÇ‡∏ä‡∏ß‡πå‡∏ö‡∏ô summary/thankyou
  window.scrollTo({ top: 0, behavior: 'auto' });
  updateCartUI();
  if (which === 'summary' || which === 'thankyou'){
    document.getElementById('cartFab')?.classList.remove('show');
  }
}

    function showBlocked(){
  const nameEl = document.getElementById('blkName');
  const linkEl = document.getElementById('blkEmail');
  const textEl = document.getElementById('blkEmailText'); // ‚Üê span ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô

  if (nameEl) nameEl.textContent = CURRENT_ADMIN_CONTACT?.name || '‚Äî';

  const mail = (CURRENT_ADMIN_CONTACT?.email || '‚Äî').trim();

  // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ô span ‡πÉ‡∏´‡πâ‡∏Ñ‡∏á‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ "Email BU Admin:" ‡πÅ‡∏•‡∏∞‡∏≠‡∏¥‡πÇ‡∏°‡∏à‡∏¥‡πÑ‡∏ß‡πâ
  if (textEl) {
    textEl.textContent = `üìß Email BU Admin: ${mail}`;
  }

  // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô mailto: ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Å‡∏£‡∏ì‡∏µ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏à‡∏£‡∏¥‡∏á
  if (linkEl) {
    linkEl.href = (mail && mail.includes('@')) ? `mailto:${mail}` : '#';
  }

  showPage('blocked');
}
function goHomeFromBlocked(){
  goHomeFromThanks(); // ‡πÉ‡∏ä‡πâ flow ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤/‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô
}


    function abortInflight(){
  try { inflight.categories?.abort(); } catch(_) {}
  try { inflight.items?.abort(); } catch(_) {}
  inflight.categories = null;
  inflight.items = null;
}
    
   function startForm(){
  resetVerifyForm();
  showPage('verify');
}

    function goHomeFromThanks(){
  FORCE_FRESH = true;
  abortInflight();
  CART = [];
  LAST_SUBMIT = null;
  updateCartUI();
  document.getElementById('cartMask')?.classList.remove('show');
  resetVerifyForm();
  showPage('verify');    // << ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤ verify
}

    function resetVerifyForm(){
  abortInflight();  

  const empInput = document.getElementById('employeeId');
  const msgBox   = document.getElementById('message');

  empInput.value = '';
  msgBox.className = 'hidden';
  msgBox.textContent = '';

  stage = 'verify';
  resetVerifyButton();

  currentCompany   = null;
  CATEGORIES       = [];
  PRODUCTS         = [];
  selectedCategory = '';

  CART = [];
  LAST_SUBMIT = null;

  // ‚úÖ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï Budget/Admin/BU cache
  CURRENT_BUDGET = null;
  CURRENT_ADMIN_CONTACT = { name: '‚Äî', email: '‚Äî' };
  CURRENT_BU_ADMIN = { names: [], emails: [] };

  updateCartUI();
  document.getElementById('cartMask')?.classList.remove('show');

  const cg = document.getElementById('categoryGrid'); if (cg) cg.innerHTML = '';
  const pg = document.getElementById('productGrid');  if (pg) pg.innerHTML = '';

  showCheckingModal(false);
}

    function goBack(){
  resetVerifyForm();
  showPage('verify');
}

   document.addEventListener('DOMContentLoaded', ()=>{
  const empInput = document.getElementById('employeeId');

  if (empInput){
    empInput.addEventListener('keydown', (e)=>{
      if(e.key === 'Enter' && stage === 'verify'){
        e.preventDefault();
        verifyEmployee();
      }
    });
  }

  // ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å = ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô
  try { resetVerifyButton(); } catch(_) {}
  showCheckingModal(false);                    // ‚¨ÖÔ∏è ‡∏õ‡∏¥‡∏î‡∏ï‡∏±‡∏ß‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Ñ‡πâ‡∏≤‡∏á
  showLoadingProductsModal(false);             // ‚¨ÖÔ∏è ‡∏õ‡∏¥‡∏î overlay ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏Ñ‡πâ‡∏≤‡∏á
  showPage('verify');
  updateCartUI();
});

    function showMsg(text, type){
      const msgBox = document.getElementById('message');
      msgBox.className = 'mt-4 p-4 rounded-lg text-center ' + (type==='error' ? 'bg-red-100 text-red-700 border border-red-200' : type==='success' ? 'alert-success' : '');
      msgBox.textContent = text;
      msgBox.classList.remove('hidden');
    }

    function stripForSearch(s){
      return String(s||'').normalize('NFKC').replace(/[\s\-‚Äì‚Äî_/\.]/g,'');
    }

    function showCheckingModal(show=true){
      const m = document.getElementById('checkingModal');
      if(!m) return;
      if(show){
        m.classList.remove('hidden');
        m.classList.add('flex');
      } else {
        m.classList.add('hidden');
        m.classList.remove('flex');
      }
    }

    async function verifyEmployee(){
      const inputEl = document.getElementById('employeeId');
      const rawInput = inputEl.value || '';
      const cleaned = stripForSearch(rawInput);
      const btn = document.getElementById('verifyBtn');
      const msgBox=document.getElementById('message');

      msgBox.classList.add('hidden');
      msgBox.textContent='';

      if(!cleaned){
        showMsg('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏Å‡πà‡∏≠‡∏ô','error');
        setCentered();
        return;
      }

      showCheckingModal(true);
      btn.disabled = true;
      btn.classList.add('opacity-80','cursor-not-allowed');

      try{
        let emp = await getEmployeeData(cleaned);
if (!emp && cleaned !== rawInput) {
  emp = await getEmployeeData(rawInput);
}
        if(emp){
  CURRENT_EMP = emp;

  // üîΩ ‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡πà‡∏≤ K/L/M ‡∏à‡∏≤‡∏Å Emp HO
  const extra = await getBudgetAndAdmin((emp.id||'').trim());
  CURRENT_BUDGET = (extra && extra.budget != null) ? Number(extra.budget) : null;
  CURRENT_ADMIN_CONTACT = {
    name:  (extra && extra.adminName)  ? String(extra.adminName)  : '‚Äî',
    email: (extra && extra.adminEmail) ? String(extra.adminEmail) : '‚Äî'
  };

  showCheckingModal(); // ‡∏õ‡∏¥‡∏î popup ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
  setProceedButton();
  preloadCategoriesFor(emp.company).catch(console.error);
}else{
          showMsg('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á','error');
          setCentered();
          resetVerifyButton();
          showCheckingModal(false);
        }
      }catch(e){
        console.error(e);
        showMsg('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏ö','error');
        showCheckingModal(false);
      }finally{
        const currentBtn = document.getElementById('verifyBtn');
        currentBtn.disabled = false;
        currentBtn.classList.remove('opacity-80','cursor-not-allowed');
      }
    }

    function setProceedButton(){
  const btn = document.getElementById('verifyBtn');
  if(!btn) return;                           // ‚¨ÖÔ∏è ‡∏Å‡∏±‡∏ô error
  stage = 'proceed';
  btn.disabled = false;
  btn.classList.remove('opacity-80','cursor-not-allowed');
  btn.textContent = '‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠';
  btn.onclick = () => showPage('category');
}

    function backToVerifyProceed(){
      showPage('verify');
      setProceedButton();
      window.scrollTo({ top: 0, behavior: 'auto' });
    }

    function resetVerifyButton(){
  const btn = document.getElementById('verifyBtn');
  if(!btn) return;                           // ‚¨ÖÔ∏è ‡∏Å‡∏±‡∏ô error
  stage = 'verify';
  btn.disabled = false;
  btn.classList.remove('opacity-80','cursor-not-allowed');
  btn.textContent = '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô';
  btn.onclick = verifyEmployee;
}

    function showLoadingProductsModal(show = true){
      const m = document.getElementById('loadingProductsModal');
      if(!m) return;
      if(show){
        m.classList.remove('hidden');
        m.classList.add('flex');
      } else {
        m.classList.add('hidden');
        m.classList.remove('flex');
      }
    }

    /* ===== Utilities: ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà/‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏ö‡∏ö‡πÑ‡∏ó‡∏¢ (‡πÉ‡∏´‡∏°‡πà) ===== */
    function formatDateTH(d=new Date()){
      return d.toLocaleDateString('th-TH', { day:'2-digit', month:'long', year:'numeric' });
    }
    function formatTimeTH(d=new Date()){
      return d.toLocaleTimeString('th-TH', { hour:'2-digit', minute:'2-digit' });
    }

    /* ===== ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å BU Admin ‡∏à‡∏≤‡∏Å Apps Script (‡πÉ‡∏´‡∏°‡πà) ===== ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ action=getBUAdmin ‡∏ù‡∏±‡πà‡∏á Apps Script (‡∏î‡∏π‡∏Ç‡∏±‡πâ‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ) */
    async function getBUAdmin(employeeId){
  try{
    const url = `${API_BASE}?action=getBUAdmin&employeeId=${encodeURIComponent(employeeId)}`;
    const res = await fetch(url, {method:'GET', cache:'no-store'});
    if(!res.ok) return { names:[], emails:[] };

    const data = await res.json().catch(()=>null);
    if(data && data.success && data.data){
      return {
        names: data.data.names || [],
        emails: data.data.emails || []
      };
    }
  }catch(_){}
  return { names:[], emails:[] };
}

      function asListHTML(arr){
  if(!arr || arr.length === 0) return '‚Äî';
  const safe = arr.map(s => String(s||'').replace(/</g,'&lt;').replace(/>/g,'&gt;'));
  return `<div class="space-y-1">${safe.map(s=>`<div>${s}</div>`).join('')}</div>`;
}                                         

    /* ===== ‡πÄ‡∏£‡∏ô‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏´‡∏ô‡πâ‡∏≤ Summary (‡πÉ‡∏´‡∏°‡πà) ===== */
    async function renderSummary(){
  // ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà/‡πÄ‡∏ß‡∏•‡∏≤
  document.getElementById('sumDate').textContent = `‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà / Date ${formatDateTH(new Date())}`;
  document.getElementById('sumTime').textContent = `‡πÄ‡∏ß‡∏•‡∏≤ / Time ${formatTimeTH(new Date())}`;

      // ‡∏ú‡∏π‡πâ‡πÄ‡∏ö‡∏¥‡∏Å
  const emp = CURRENT_EMP || {};
  document.getElementById('s_company').textContent  = emp.company || '-';
  document.getElementById('s_empid').textContent    = emp.id || '-';
  document.getElementById('s_cost').textContent     = emp.costCenter || '-';
  document.getElementById('s_fullname').textContent = emp.name || '-';

  // BU Admin (‡∏î‡∏∂‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÅ‡∏•‡πâ‡∏ß cache)
  const bu = await getBUAdmin(emp.id || '');
  CURRENT_BU_ADMIN = {
  names: bu.names || [],
  emails: bu.emails || []
};

document.getElementById('s_bu_name').innerHTML  = asListHTML(CURRENT_BU_ADMIN.names);
document.getElementById('s_bu_email').innerHTML = asListHTML(CURRENT_BU_ADMIN.emails);

      // ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
  const wrap = document.getElementById('sumItems');
  if(!wrap) return;

  if(!CART || CART.length===0){
    wrap.innerHTML = `<div class="text-center text-gray-500">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div>`;
    document.getElementById('sumTotal').textContent = '‡∏ø0';
    return;
  }

     const rowsHtml = CART.map((it, i) => {
    const qty  = Number(it.qty)||0;
    const unit = Number(it.price)||0;
    const line = qty*unit;

    const name = (it.name||'-').replace(/</g,'&lt;').replace(/>/g,'&gt;');
    const desc = (it.detail||'').replace(/</g,'&lt;').replace(/>/g,'&gt;');
    const img  = (it.image||'').replace(/"/g,'&quot;') || 'https://via.placeholder.com/34?text=%20';
       
        return `
      <tr>
        <td class="sum-col-idx">${i+1}</td>
        <td>
          <div class="sum-itembox">
            <img class="sum-thumb" src="${img}" onerror="this.src='https://via.placeholder.com/34?text=%20'" alt="">
            <div>
              <div class="sum-name">${name}</div>
              ${desc?`<div class="sum-desc">${desc}</div>`:''}
            </div>
          </div>
        </td>
        <td class="sum-col-qty">${qty}</td>
        <td class="sum-col-unit">${baht(unit)}</td>
        <td class="sum-col-line">${baht(line)}</td>
      </tr>
    `;
  }).join('');

       const tableHtml = `
    <table class="sum-table">
      <thead>
        <tr>
          <th class="sum-col-idx">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
          <th>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
          <th class="sum-col-qty">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
          <th class="sum-col-unit">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢</th>
          <th class="sum-col-line">‡∏£‡∏ß‡∏°</th>
        </tr>
      </thead>
      <tbody>${rowsHtml}</tbody>
      <tfoot>
        <tr>
          <td colspan="4" style="text-align:right;">‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:</td>
          <td class="sum-col-line">${baht(cartSum())}</td>
        </tr>
      </tfoot>
    </table>
  `;
  wrap.innerHTML = tableHtml;

  // ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏£‡∏ß‡∏°‡πÉ‡∏ï‡πâ‡∏ï‡∏≤‡∏£‡∏≤‡∏á (‡∏Ç‡∏≠‡∏á‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏î‡∏¥‡∏°)
  document.getElementById('sumTotal').textContent = baht(cartSum());
}

   /* ===== ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏ö‡∏¥‡∏Å (‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á‡∏ä‡∏µ‡∏ï Response) ===== */
let IS_SUBMITTING = false;   // ‚úÖ ‡∏Å‡∏±‡∏ô‡∏Å‡∏î‡∏ã‡πâ‡∏≥

async function submitRequest(){
  if (IS_SUBMITTING) return;
  IS_SUBMITTING = true;
  showSubmittingModal(true);

  try {
    if (!CURRENT_EMP) {
      alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô‡∏Å‡πà‡∏≠‡∏ô');
      showPage('verify');
      return;
    }
    if (!CART || CART.length === 0) {
      alert('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤');
      return;
    }

    // ‚õî Gate: ‡∏ï‡∏£‡∏ß‡∏à‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏à‡∏≤‡∏Å Emp HO (‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå K)
   if (CURRENT_BUDGET === null) {
  const more = await getBudgetAndAdmin((CURRENT_EMP.id||'').trim());
  CURRENT_BUDGET = (more && more.budget != null) ? Number(more.budget) : 0;
  CURRENT_ADMIN_CONTACT = {
    name:  (more && more.adminName)  ? String(more.adminName)  : '‚Äî',
    email: (more && more.adminEmail) ? String(more.adminEmail) : '‚Äî'
  };
}
    if (!CURRENT_BUDGET || Number(CURRENT_BUDGET) === 0) {
      showSubmittingModal(false);
      showBlocked();       // ‚ûú ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ ‚Äú‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠‚Äù
      return;              // ‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠
    }

    // ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏° payload
    const items = CART.map(it => ({
      name: it.name,
      qty: Number(it.qty)||0,
      price: Number(it.price)||0,
      line: (Number(it.qty)||0) * (Number(it.price)||0),
      detail: it.detail || '',
      image: it.image || ''
    }));

    const now = new Date();
    const d = String(now.getDate()).padStart(2,'0');
    const m = String(now.getMonth()+1).padStart(2,'0');
    const y = now.getFullYear() + 543;
    const dateTH = `${d}/${m}/${y}`;
    const timeTH = now.toLocaleTimeString('th-TH', { hour:'2-digit', minute:'2-digit' });

    const totalQty  = items.reduce((s, x) => s + x.qty, 0);
    const totalCost = items.reduce((s, x) => s + x.line, 0);

    const row = {
      '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà': dateTH,
      '‡πÄ‡∏ß‡∏•‡∏≤': timeTH,
      '‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó': CURRENT_EMP.company || '',
      'Cost Center': CURRENT_EMP.costCenter || '',
      '‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô': CURRENT_EMP.id || '',
      '‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•': CURRENT_EMP.name || '',
      'Name BU admin': (CURRENT_BU_ADMIN.names || []).join(' | ') || '‚Äî',
      'Email BU Admin': (CURRENT_BU_ADMIN.emails || []).join(' | ') || '‚Äî',
      '‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å (‡∏ä‡∏¥‡πâ‡∏ô)': totalQty,
      '‡∏¢‡∏≠‡∏î‡πÄ‡∏ö‡∏¥‡∏Å (‡∏ö‡∏≤‡∏ó)': totalCost
    };
    items.forEach((it, idx) => {
      const n = idx + 1;
      row[`‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà ${n}`] = it.name;
      row[`‡∏à‡∏≥‡∏ô‡∏ß‡∏ô ${n}`]   = Number(it.qty) || 0;
      row[`‡∏£‡∏≤‡∏Ñ‡∏≤ ${n}`]    = Number(it.price) || 0;
    });

    const params = new URLSearchParams();
    params.set('action', 'submitRequest');
    params.set('row', JSON.stringify(row));

    const ctrl = new AbortController();
    const timer = setTimeout(()=>ctrl.abort('timeout'), 30000);

    const res = await fetch(API_BASE, {
      method: 'POST',
      headers: { 'Content-Type': 'application/x-www-form-urlencoded;charset=UTF-8' },
      body: params.toString(),
      cache: 'no-store',
      signal: ctrl.signal
    }).catch(err => { throw new Error(err?.message || 'network error'); });

    clearTimeout(timer);

    const raw = await res.text();
    let json = null;
    try { json = JSON.parse(raw); } catch(_) {}

    if (!res.ok) {
      const msg = (json && (json.message || json.error)) || `HTTP ${res.status}`;
      throw new Error(msg);
    }
    if (!json || json.success !== true) {
      throw new Error((json && (json.message || json.error)) || '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
    }

    LAST_SUBMIT = {
      ref: (json.ref || (json.row ? `REQ-${String(json.row).padStart(5,'0')}` : '‚Äî')),
      totalQty: totalQty,
      totalAmount: totalCost
    };

    // ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤ + ‡πÑ‡∏õ Thank You
    CART = [];
    updateCartUI();
    showSubmittingModal(false);
    showPage('thankyou');
    renderThankYou();

  } catch (err) {
    console.error(err);
    showSubmittingModal(false);
    alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠: ' + (err.message || '‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏'));
  } finally {
    IS_SUBMITTING = false;  // ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡∏õ‡∏∏‡πà‡∏°‡∏™‡πà‡∏á
  }
}

    function renderThankYou(){
  const d = LAST_SUBMIT || {};
  // ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà/‡πÄ‡∏ß‡∏•‡∏≤‡πÑ‡∏ó‡∏¢
  const now = new Date();
  const dateTH = now.toLocaleDateString('th-TH', { day:'2-digit', month:'long', year:'numeric' });

  document.getElementById('tyRef').textContent   = d.ref || '‚Äî';
  document.getElementById('tyQty').textContent   = (d.totalQty ?? 0) + ' ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£';
  document.getElementById('tyTotal').textContent = '‡∏ø' + Number(d.totalAmount||0).toLocaleString('th-TH', {minimumFractionDigits:2});
  document.getElementById('tyDate').textContent  = dateTH;
}
    document.addEventListener('keydown', (e) => {
  if (e.key === 'Escape') {
    // ‡∏õ‡∏¥‡∏î modal ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
    const modal = document.getElementById('itemModal');
    if (modal && modal.style.display === 'flex') closeItemModal();

    // ‡∏õ‡∏¥‡∏î‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤
    const mask = document.getElementById('cartMask');
    if (mask && mask.classList.contains('show')) closeCart();

    // ‡∏õ‡∏¥‡∏î loading/submitting modal ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà (‡∏Å‡∏±‡∏ô‡∏Ñ‡πâ‡∏≤‡∏á)
    ['checkingModal','loadingProductsModal','submittingModal'].forEach(id=>{
      const m = document.getElementById(id);
      if (m && m.classList.contains('flex')) m.classList.add('hidden');
      if (m) m.classList.remove('flex');
    });
  }
});
    
  </script>

  <!-- Cart Drawer -->
  <div id="cartMask" class="cart-mask" onclick="closeCart()">
    <div id="cartPanel" class="cart-panel" onclick="event.stopPropagation();">
      <div class="cart-header">
        <div style="font-size:1.3rem;font-weight:900;">‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</div>
        <div style="opacity:.85;">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</div>
        <div class="icon">
          <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M3 3h2l.4 2M7 13h9l3-8H6.4M7 13L5.4 5M7 13l-2 6h13M10 21a1 1 0 110-2 1 1 0 010 2z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          <span id="cartBadgeHdr" class="cart-badge">0</span>
        </div>
      </div>

      <div id="cartItems" class="cart-body"></div>

      <div class="cart-footer">
        <div class="cart-total">
          <span>‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:</span>
          <span id="cartSum" style="color:#10b981;">‡∏ø0</span>
        </div>
        <div class="cart-actions">
          <button class="cart-btn-secondary" onclick="closeCart()">‚Üê ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
          <button class="cart-btn-primary" onclick="proceedCart()">‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</button>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
